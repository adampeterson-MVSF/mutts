(globalThis.TURBOPACK || (globalThis.TURBOPACK = [])).push([typeof document === "object" ? document.currentScript : undefined,
"[project]/lib/log.ts [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

// lib/log.ts
/**
 * Structured logging with Pino for production observability
 *
 * Replaces console.log with structured JSON logging for:
 * - Metrics aggregation (rate_limit.rejections, auth.redirects, etc.)
 * - Alerting (SLO violations)
 * - Debugging (correlated request tracing)
 */ __turbopack_context__.s([
    "createRequestLogger",
    ()=>createRequestLogger,
    "log",
    ()=>log,
    "metrics",
    ()=>metrics
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$polyfills$2f$process$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = /*#__PURE__*/ __turbopack_context__.i("[project]/node_modules/next/dist/build/polyfills/process.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$pino$2f$browser$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/pino/browser.js [app-client] (ecmascript)");
;
// Configure Pino with production-safe settings
const inEdge = typeof globalThis.EdgeRuntime !== "undefined";
const useTransport = !inEdge && __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$polyfills$2f$process$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["default"].env.PINO_TRANSPORT !== "none" && ("TURBOPACK compile-time value", "development") === "production"; // use worker only in prod
const log = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$pino$2f$browser$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["default"])({
    level: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$polyfills$2f$process$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["default"].env.LOG_LEVEL ?? "info",
    redact: {
        paths: [
            "req.headers.authorization",
            "req.headers.cookie",
            "req.body.password",
            "req.body.confirmPassword",
            "password",
            "token"
        ],
        censor: "[redacted]"
    },
    // Add hostname and service name for multi-service correlation
    base: {
        service: "senior-dog-rescue",
        hostname: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$polyfills$2f$process$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["default"].env.HOSTNAME || "unknown"
    },
    // Pretty print in development for readability (but avoid worker transport)
    ...useTransport && {
        transport: {
            target: "pino-pretty",
            options: {
                colorize: true,
                translateTime: "SYS:standard",
                ignore: "hostname,pid"
            }
        }
    }
});
const metrics = {
    // Rate limiting metrics
    rateLimitRejection: (route, ipHash, userId)=>log.warn({
            metric: "rate_limit.rejections",
            route,
            ipHash,
            userId,
            value: 1
        }, "Rate limit exceeded"),
    // Authentication metrics
    authRedirect: (route, reason, userRole)=>log.info({
            metric: "auth.redirects",
            route,
            reason,
            userRole,
            value: 1
        }, "Authentication redirect"),
    // Image security metrics
    unknownImageHostRejection: (host, route)=>log.warn({
            metric: "unknown_image_host_rejections",
            host,
            route,
            value: 1
        }, "Unknown image host rejected"),
    // API latency metrics (p50/p95 tracking)
    apiLatency: (route, method, statusCode, durationMs, userRole)=>log.info({
            metric: "api.latency_ms",
            route,
            method,
            statusCode,
            durationMs,
            userRole,
            value: durationMs
        }, "API request completed"),
    // Error metrics
    serverError: (route, error, statusCode)=>log.error({
            metric: "server.errors",
            route,
            error,
            statusCode,
            value: 1
        }, "Server error occurred")
};
function createRequestLogger(requestId, route) {
    return log.child({
        requestId,
        route
    });
}
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/lib/image-loader.ts [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

// lib/image-loader.ts
// Custom Next.js Image loader with telemetry for domain validation
__turbopack_context__.s([
    "default",
    ()=>imageLoader
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$polyfills$2f$process$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = /*#__PURE__*/ __turbopack_context__.i("[project]/node_modules/next/dist/build/polyfills/process.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$log$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/lib/log.ts [app-client] (ecmascript)");
;
// Allowed domains from next.config.ts for reference
const ALLOWED_DOMAINS = [
    'via.placeholder.com',
    'picsum.photos',
    'scontent.xx.fbcdn.net',
    'external.xx.fbcdn.net',
    'dl5zpyw5k3jeb.cloudfront.net',
    'assets.adoptapet.com',
    'muttville.org'
];
function imageLoader({ src, width, quality }) {
    // Extract hostname from src URL for telemetry
    try {
        const url = new URL(src);
        const hostname = url.hostname;
        // Get Supabase hostname if available
        const supabaseUrl = ("TURBOPACK compile-time value", "https://xcegtpafqfoksbkhdezj.supabase.co");
        let supabaseHostname = null;
        if ("TURBOPACK compile-time truthy", 1) {
            try {
                supabaseHostname = new URL(supabaseUrl).hostname;
            } catch  {
            // Invalid Supabase URL
            }
        }
        const allAllowedDomains = supabaseHostname ? [
            ...ALLOWED_DOMAINS,
            supabaseHostname
        ] : ALLOWED_DOMAINS;
        // Check if domain is in allowlist
        const isAllowed = allAllowedDomains.some((allowed)=>{
            if (allowed.includes('xx')) {
                // Handle Facebook's region-specific domains
                return hostname.includes('fbcdn.net');
            }
            return hostname === allowed || hostname === 'localhost'; // Allow localhost for development
        });
        if (!isAllowed) {
            // Emit SLO metric for unknown image host rejections
            __TURBOPACK__imported__module__$5b$project$5d2f$lib$2f$log$2e$ts__$5b$app$2d$client$5d$__$28$ecmascript$29$__["metrics"].unknownImageHostRejection(hostname, 'image-loader');
            const errorMsg = `[ImageLoader] ðŸš« Domain not allowed: ${hostname}. Add to next.config.ts remotePatterns if legitimate.`;
            console.error(errorMsg);
            console.error(`[ImageLoader] Allowed domains: ${allAllowedDomains.join(', ')}`);
            console.error(`[ImageLoader] Image source: ${src}`);
            // In development, this will help catch configuration issues early
            if ("TURBOPACK compile-time truthy", 1) {
                console.error(`[ImageLoader] To fix: Add '${hostname}' to remotePatterns in next.config.ts`);
            }
        } else {
            // Log allowed domain usage for monitoring
            console.log(`[ImageLoader] âœ… Loading image from allowed domain: ${hostname}`);
        }
        // In development, warn about potentially problematic sources
        if ("TURBOPACK compile-time truthy", 1) {
            const suspiciousPatterns = [
                'http:',
                'localhost',
                '127.0.0.1',
                '0.0.0.0'
            ];
            const isSuspicious = suspiciousPatterns.some((pattern)=>src.includes(pattern));
            if (isSuspicious) {
                console.warn(`[ImageLoader] âš ï¸  Suspicious image source (allowed but review): ${src}`);
            }
        }
    } catch (error) {
        // If URL parsing fails, log the error for debugging
        console.error(`[ImageLoader] Failed to parse image URL: ${src}`, error);
    }
    // Use Next.js default loader behavior
    return `${src}?w=${width}&q=${quality || 75}`;
}
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
"[project]/components/ClientTimestamp.tsx [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "ClientTimestamp",
    ()=>ClientTimestamp
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/jsx-dev-runtime.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/compiled/react/index.js [app-client] (ecmascript)");
;
var _s = __turbopack_context__.k.signature();
"use client";
;
function ClientTimestamp({ date, options }) {
    _s();
    const [formatted, setFormatted] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useState"])("");
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["useEffect"])({
        "ClientTimestamp.useEffect": ()=>{
            const dateObj = new Date(date);
            setFormatted(dateObj.toLocaleDateString(undefined, options));
        }
    }["ClientTimestamp.useEffect"], [
        date,
        options
    ]);
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$compiled$2f$react$2f$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
        children: formatted
    }, void 0, false, {
        fileName: "[project]/components/ClientTimestamp.tsx",
        lineNumber: 18,
        columnNumber: 10
    }, this);
}
_s(ClientTimestamp, "9VfZerPq4GGnNo1WqTHjG/3lGTg=");
_c = ClientTimestamp;
var _c;
__turbopack_context__.k.register(_c, "ClientTimestamp");
if (typeof globalThis.$RefreshHelpers$ === 'object' && globalThis.$RefreshHelpers !== null) {
    __turbopack_context__.k.registerExports(__turbopack_context__.m, globalThis.$RefreshHelpers$);
}
}),
]);

//# sourceMappingURL=_5216d20d._.js.map