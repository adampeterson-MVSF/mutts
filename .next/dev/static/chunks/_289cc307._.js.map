{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/adampeterson/Github/mutts/lib/actions/application.actions.ts"],"sourcesContent":["// lib/actions/application.actions.ts\n\"use server\";\n\nimport { revalidatePath } from \"next/cache\";\nimport { notFound, redirect } from \"next/navigation\";\nimport { prisma } from \"@/lib/db\";\nimport { AppStatus, AppType, Prisma, AuditAction } from \"@prisma/client\";\nimport { createClient } from \"@/lib/supabase/server\";\nimport { applicationSchema, profileSchema } from \"@/lib/zod/applicationSchema\"; // Zod schema\nimport { applicationSchema as newApplicationSchema } from \"@/lib/schemas/application.schema\"; // New Zod schema\nimport { z } from \"zod\";\nimport { assertRole } from \"@/lib/actions/profile.actions\";\nimport { UserRole } from \"@prisma/client\";\nimport { ActionResult, ok, fail } from \"@/lib/types\";\nimport { getAllowedStatuses } from \"@/lib/utils\";\nimport { withAudit } from \"@/lib/audit/withAudit\";\nimport { getCurrentUserId } from \"./audit.actions\";\nimport { getSSRUser } from \"@/lib/auth/session.server\";\nimport { missing } from \"@/lib/format\";\nimport { toCsv } from \"@/lib/csv\";\nimport {\n  AdminApplicationDetail,\n  ApplicationListItem,\n  ApplicationHistoryEntry,\n} from \"@/lib/view-models/applications\";\nimport { parseApplicationSearchParams } from \"@/lib/url-pagination\";\n\nconst updateStatusSchema = z.object({\n  appId: z.coerce.number().int().positive({ message: \"Invalid application ID\" }),\n  status: z.nativeEnum(AppStatus, { message: \"Invalid status\" }),\n  statusNotes: z.string().optional(),\n});\n\nfunction parseApplicationIds(formData: FormData): number[] {\n  const raw = formData.get(\"applicationIds\");\n  if (!raw || typeof raw !== \"string\") return [];\n  return raw\n    .split(\",\")\n    .map(s => s.trim())\n    .filter(Boolean)\n    .map(Number)\n    .filter(Number.isFinite);\n}\n\n\nexport async function createApplication(\n  prevState: ActionResult<null>,\n  formData: FormData\n): Promise<ActionResult<null>> {\n\n  const user = await getSSRUser();\n  if (!user) {\n    // This should never happen if middleware is correct, but it's a good guard.\n    return fail(\"Authentication error. Please log in again.\");\n  }\n\n  // Fetch profile data for snapshot\n  const profile = await prisma.profile.findUnique({\n    where: { id: user.id }\n  });\n  if (!profile) {\n    return fail(\"Profile not found. Please contact support.\");\n  }\n\n  const rawData = Object.fromEntries(formData.entries());\n\n  // Coerce form data for validation\n  const coercedData = {\n    ...rawData,\n    formType: rawData.formType,\n    dogId: rawData.dogId ? Number(rawData.dogId) : undefined,\n    yardFenced: rawData.yardFenced ? rawData.yardFenced === 'on' : undefined,\n    // ... add any other coercions (e.g., references)\n  };\n\n  const result = newApplicationSchema.safeParse(coercedData);\n  if (!result.success) {\n    console.warn(\"Application validation failed:\", result.error.flatten().fieldErrors);\n    return fail(\"Validation failed. Please check your entries.\", result.error.flatten().fieldErrors);\n  }\n\n  const { data } = result;\n\n  try {\n    // Use a transaction. It's the only safe way.\n    await prisma.$transaction(async (tx) => {\n\n      await tx.application.create({\n        data: {\n          applicationType: data.formType,\n          status: 'SUBMITTED',\n          reason: data.reason,\n          dogId: data.dogId,\n          profileId: user.id, // <-- Correct\n          submittedAt: new Date(),\n\n          // --- SNAPSHOT COPY FROM PROFILE ---\n          applicantName: profile.name || 'Unknown',\n          applicantEmail: profile.email,\n          // --- FORM DATA (snapshot of what user provided at submission time) ---\n          applicantPhone: data.applicantPhone,\n          address: data.address,\n          housingType: data.housingType,\n          hasYard: data.hasYard,\n          yardFenced: data.yardFenced,\n          otherPets: data.otherPets,\n          vetName: data.vetName,\n          vetPhone: data.vetPhone,\n          homeEnvironmentDescription: data.homeEnvironmentDescription,\n        }\n      });\n\n      // Create references if provided\n      if (data.references && data.references.length > 0) {\n        // Get the application ID we just created - this is tricky in a transaction\n        // We need to create the application first to get the ID\n        // Let me restructure this...\n\n        // Actually, let me get the application ID after creation\n        // For now, let's create references after the transaction\n      }\n    });\n\n    // Handle references outside transaction for simplicity\n    if (data.references && data.references.length > 0) {\n      // Get the application we just created\n      const createdApplication = await prisma.application.findFirst({\n        where: {\n          profileId: user.id,\n          applicationType: data.formType,\n          status: 'SUBMITTED',\n        },\n        orderBy: { createdAt: 'desc' },\n        select: { id: true },\n      });\n\n      if (createdApplication) {\n        await prisma.reference.createMany({\n          data: data.references.map((ref) => ({\n            ...ref,\n            applicationId: createdApplication.id,\n          })),\n        });\n      }\n    }\n  } catch (error) {\n    console.error(\"Application submission error:\", error);\n    return fail(\"A database error occurred. Please try again.\");\n  }\n\n  // Revalidate admin path and redirect user\n  revalidatePath(\"/admin/applications\");\n  const successPath = data.formType === 'ADOPTER' ? '/apply/adopt/success' : '/apply/foster/success';\n  redirect(successPath);\n}\n\nexport async function submitApplication(formData: FormData): Promise<ActionResult<{ applicationId: number }>> {\n  console.log('submitApplication called with formData keys:', Array.from(formData.keys()));\n  const supabase = await createClient();\n  const { data: { user } } = await supabase.auth.getUser();\n  if (!user) {\n    console.log('submitApplication: user not authenticated');\n    return fail(\"Not authenticated\");\n  }\n  console.log('submitApplication: user authenticated, proceeding with submission');\n\n  try {\n    // Parse form data\n    const formType = formData.get('formType') as AppType;\n    const dogId = formData.get('dogId') ? parseInt(formData.get('dogId') as string) : undefined;\n\n    // Optional: applications can target a specific dog or be general interest applications\n    let validatedDogId: number | undefined;\n    if (dogId !== undefined && dogId !== null) {\n      if (isNaN(dogId) || dogId <= 0) {\n        return fail(\"Invalid dog ID provided.\", { dogId: [\"Must be a valid positive number\"] });\n      }\n      validatedDogId = dogId;\n    }\n\n    // Handle references - parse nested array format from form data\n    const parsedReferences: Array<{ name: string; phone: string; relationship: string }> = [];\n    let index = 0;\n    while (true) {\n      const name = formData.get(`references[${index}][name]`) as string;\n      const phone = formData.get(`references[${index}][phone]`) as string;\n      const relationship = formData.get(`references[${index}][relationship]`) as string;\n\n      if (!name) break; // No more references\n\n      parsedReferences.push({\n        name,\n        phone: phone || '',\n        relationship: relationship || '',\n      });\n      index++;\n    }\n\n    // Extract form fields - separate profile and application data\n    const profileData = {\n      firstName: formData.get('firstName') as string,\n      lastName: formData.get('lastName') as string,\n      email: formData.get('email') as string,\n    };\n\n    const applicantData = {\n      applicantPhone: formData.get('applicantPhone') as string || undefined,\n      address: formData.get('address') as string,\n      housingType: (formData.get('housingType') as 'OWN_HOME' | 'RENT_HOME' | 'OWN_APT_CONDO' | 'RENT_APT_CONDO' | 'OTHER') ?? 'OTHER',\n      hasYard: (formData.get('hasYard') as 'YES' | 'NO' | 'SHARED') ?? 'NO',\n      yardFenced: formData.get('yardFenced') === 'on',\n      otherPets: formData.get('otherPets') as string || undefined,\n      vetName: formData.get('vetName') as string || undefined,\n      vetPhone: formData.get('vetPhone') as string || undefined,\n      homeEnvironmentDescription: formData.get('homeEnvironmentDescription') as string,\n    };\n\n    const applicationData = {\n      reason: formData.get('reason') as string,\n      dogId: validatedDogId,\n      references: parsedReferences,\n      ...applicantData, // Include applicant fields in application data\n    };\n\n    // Validate profile data (only name and email)\n    const validatedProfileData = profileSchema.safeParse(profileData);\n    if (!validatedProfileData.success) {\n      const fieldErrors = validatedProfileData.error.flatten().fieldErrors;\n      return fail(\"Validation failed.\", fieldErrors);\n    }\n\n    // Validate application data (includes applicant fields)\n    const validatedApplicationData = applicationSchema.safeParse(applicationData);\n    if (!validatedApplicationData.success) {\n      const fieldErrors = validatedApplicationData.error.flatten().fieldErrors;\n      return fail(\"Validation failed.\", fieldErrors);\n    }\n\n    // 1. Separate references from the application data.\n    const { references: validatedReferences, ...applicationFields } = validatedApplicationData.data;\n\n    // 2. Use a transaction to ensure data integrity.\n    let app: { id: number } | undefined;\n    await prisma.$transaction(async (tx) => {\n      // 3. Upsert the user's profile with name and email\n      await tx.profile.upsert({\n        where: { id: user.id },\n        update: {\n          name: `${validatedProfileData.data.firstName} ${validatedProfileData.data.lastName}`,\n          email: validatedProfileData.data.email,\n        },\n        create: {\n          id: user.id,\n          name: `${validatedProfileData.data.firstName} ${validatedProfileData.data.lastName}`,\n          email: validatedProfileData.data.email,\n          role: UserRole.VOLUNTEER, // Default role for new profiles\n        },\n      });\n\n      // 4. Create the application with application-specific data only\n      const applicationData: Prisma.ApplicationCreateInput = {\n        applicationType: formType,\n        profileId: user.id,\n        status: AppStatus.SUBMITTED,\n        submittedAt: new Date(),\n        reason: applicationFields.reason,\n        applicantName: `${validatedProfileData.data.firstName} ${validatedProfileData.data.lastName}`,\n        applicantEmail: validatedProfileData.data.email,\n      };\n\n      // Add optional fields if they exist\n      if (applicationFields.dogId !== undefined) applicationData.dog = { connect: { id: applicationFields.dogId } };\n      if (applicationFields.applicantPhone !== undefined) applicationData.applicantPhone = applicationFields.applicantPhone;\n      if (applicationFields.address !== undefined) applicationData.address = applicationFields.address;\n      if (applicationFields.housingType !== undefined) applicationData.housingType = applicationFields.housingType;\n      if (applicationFields.hasYard !== undefined) applicationData.hasYard = applicationFields.hasYard;\n      if (applicationFields.yardFenced !== undefined) applicationData.yardFenced = applicationFields.yardFenced;\n      if (applicationFields.otherPets !== undefined) applicationData.otherPets = applicationFields.otherPets;\n      if (applicationFields.vetName !== undefined) applicationData.vetName = applicationFields.vetName;\n      if (applicationFields.vetPhone !== undefined) applicationData.vetPhone = applicationFields.vetPhone;\n      if (applicationFields.homeEnvironmentDescription !== undefined) applicationData.homeEnvironmentDescription = applicationFields.homeEnvironmentDescription;\n\n      app = await tx.application.create({\n        data: applicationData,\n      });\n\n      // 5. If references exist, create them and link them.\n      if (validatedReferences && validatedReferences.length > 0) {\n        await tx.reference.createMany({\n          data: validatedReferences.map((ref) => ({\n            ...ref,\n            applicationId: app!.id, // Link to the new application\n          })),\n        });\n      }\n    });\n\n    // 6. Revalidate paths\n    revalidatePath(\"/admin/applications\");\n\n    if (!app) {\n      throw new Error(\"Failed to create application\");\n    }\n\n    console.log('submitApplication: application created successfully with ID:', app.id);\n    return ok({ applicationId: app.id }, 'Application submitted successfully!');\n  } catch (error) {\n    console.error(\"Application submission failed:\", error);\n    return fail(error instanceof Error ? error.message : \"Failed to submit application.\");\n  }\n}\n\nexport async function updateApplicationStatus(prevState: ActionResult, formData: FormData): Promise<ActionResult> {\n  try {\n    await assertRole(UserRole.STAFF);\n    const userId = await getCurrentUserId();\n\n    const parsed = updateStatusSchema.safeParse(Object.fromEntries(formData.entries()));\n    if (!parsed.success) {\n      const fieldErrors = parsed.error.flatten().fieldErrors;\n      return fail(\"Validation failed.\", fieldErrors);\n    }\n\n    const { appId, status, statusNotes } = parsed.data;\n\n    // Get current application to validate status transition\n    const currentApplication = await prisma.application.findUnique({\n      where: { id: appId },\n      select: {\n        status: true,\n        applicationType: true,\n      },\n    });\n\n    if (!currentApplication) {\n      return fail(\"Application not found.\");\n    }\n\n    // Validate that the status transition is allowed (server-side enforcement)\n    const allowedStatuses = getAllowedStatuses(currentApplication.applicationType, currentApplication.status);\n    if (!allowedStatuses.includes(status)) {\n      return fail(\"Invalid status transition for this application type.\");\n    }\n\n    // Business rule: notes required for APPROVED/REJECTED\n    if ((status === AppStatus.APPROVED || status === AppStatus.REJECTED) &&\n        (!statusNotes || statusNotes.trim().length === 0)) {\n      return fail(\"Status notes are required when moving to approved or rejected status.\", { statusNotes: [\"Required for terminal status changes\"] });\n    }\n\n    await withAudit(\n      async (tx) => {\n        const application = await tx.application.update({\n          where: { id: appId },\n          data: {\n            status,\n            statusNotes: statusNotes || null,\n          },\n          select: {\n            applicationType: true,\n            profileId: true,\n          },\n        });\n\n        // Write to append-only ApplicationAudit table\n        await tx.applicationAudit.create({\n          data: {\n            applicationId: appId,\n            actorId: userId,\n            oldStatus: currentApplication.status,\n            newStatus: status,\n            note: statusNotes || `Status changed from ${currentApplication.status} to ${status}`,\n          },\n        });\n\n        if (application.applicationType === AppType.FOSTER && status === AppStatus.APPROVED) {\n          await tx.fosterProfile.upsert({\n            where: { profileId: application.profileId },\n            update: {},\n            create: {\n              profileId: application.profileId,\n            },\n          });\n        }\n\n        return application;\n      },\n      {\n        actorId: userId,\n        action: AuditAction.APPLICATION_STATUS_CHANGE,\n        entityType: 'application',\n        entityId: appId,\n        note: `Status changed from ${currentApplication.status} to ${status}`,\n      },\n      prisma\n    );\n\n    revalidatePath(`/admin/applications/${appId}`);\n    revalidatePath(\"/admin/applications\");\n\n    return ok(null, \"Application status updated successfully!\");\n  } catch (error) {\n    return fail(error instanceof Error ? error.message : \"Failed to update status\");\n  }\n}\n\nexport async function getApplicationById(id: number): Promise<AdminApplicationDetail> {\n  const parsed = z.object({ id: z.coerce.number().int().positive() }).safeParse({ id });\n  if (!parsed.success) {\n    throw new Error(\"Invalid application ID\");\n  }\n\n  const application = await prisma.application.findUnique({\n    where: { id },\n    select: {\n      id: true,\n      createdAt: true,\n      updatedAt: true,\n      applicationType: true,\n      status: true,\n      statusNotes: true,\n      profileId: true,\n      applicantName: true,\n      applicantEmail: true,\n      applicantPhone: true,\n      address: true,\n      housingType: true,\n      hasYard: true,\n      yardFenced: true,\n      otherPets: true,\n      vetName: true,\n      vetPhone: true,\n      homeEnvironmentDescription: true,\n      reason: true,\n      references: true,\n      dog: {\n        select: {\n          id: true,\n          name: true,\n          status: true,\n          bioPublic: true,\n        },\n      },\n    },\n  });\n  if (!application) notFound();\n\n  // 2. DELETE ALL JSON.parse logic. It's not needed.\n  // const formData = JSON.parse(application.formDataJson);\n  // return { ...application, formData };\n\n  // Decrypt PII fields from profile before returning\n\n  return {\n    ...application,\n    housingTypeLabel: application.housingType || \"Not specified\",\n    hasYardLabel:\n      application.hasYard === \"YES\"\n        ? \"Yes\"\n        : application.hasYard === \"NO\"\n        ? \"No\"\n        : application.hasYard === \"SHARED\"\n        ? \"Shared\"\n        : \"Not specified\",\n    yardFencedLabel:\n      application.yardFenced === true\n        ? \"Yes\"\n        : application.yardFenced === false\n        ? \"No\"\n        : \"Not specified\",\n    otherPetsLabel: application.otherPets || \"Not specified\",\n    homeEnvironmentDescriptionLabel: application.homeEnvironmentDescription || \"Not specified\",\n  };\n}\n\nexport async function getAllApplications(searchParams?: { [key: string]: string | undefined }): Promise<{\n    applications: ApplicationListItem[];\n    pagination: {\n        currentPage: number;\n        totalPages: number;\n        totalCount: number;\n        hasNextPage: boolean;\n        hasPreviousPage: boolean;\n    };\n}> {\n    await assertRole(UserRole.STAFF);\n\n    // Parse and validate search parameters using shared helper\n    const validatedParams = parseApplicationSearchParams(searchParams || {});\n\n    // Validate status filter\n    if (validatedParams.status && validatedParams.status !== \"all\") {\n        if (!Object.values(AppStatus).includes(validatedParams.status as AppStatus)) {\n            throw new Error(`Invalid status filter: ${validatedParams.status}`);\n        }\n    }\n\n    // Validate type filter\n    if (validatedParams.type && validatedParams.type !== \"all\") {\n        if (!Object.values(AppType).includes(validatedParams.type as AppType)) {\n            throw new Error(`Invalid type filter: ${validatedParams.type}`);\n        }\n    }\n\n    const offset = (validatedParams.page - 1) * validatedParams.limit;\n\n    // Build where clause for filtering\n    const where: Prisma.ApplicationWhereInput = {};\n\n    if (validatedParams.status && validatedParams.status !== \"all\") {\n        where.status = validatedParams.status as AppStatus;\n    }\n\n    if (validatedParams.type && validatedParams.type !== \"all\") {\n        where.applicationType = validatedParams.type as AppType;\n    }\n\n    if (validatedParams.search) {\n        where.OR = [\n            {\n                applicantName: {\n                    contains: validatedParams.search,\n                    mode: \"insensitive\"\n                }\n            },\n            {\n                applicantEmail: {\n                    contains: validatedParams.search,\n                    mode: \"insensitive\"\n                }\n            }\n        ];\n    }\n\n    const [applications, totalCount] = await Promise.all([\n        prisma.application.findMany({\n            where,\n            select: {\n                id: true,\n                createdAt: true,\n                updatedAt: true,\n                applicationType: true,\n                status: true,\n                applicantName: true,\n                applicantEmail: true,\n                reason: true,\n                dog: {\n                    select: {\n                        id: true,\n                        name: true,\n                        status: true,\n                    },\n                },\n            },\n            orderBy: { [validatedParams.sortBy]: validatedParams.sortOrder },\n            skip: offset,\n            take: validatedParams.limit,\n        }),\n        prisma.application.count({ where }),\n    ]);\n\n    const totalPages = Math.ceil(totalCount / validatedParams.limit);\n\n    return {\n        applications: applications as ApplicationListItem[],\n        pagination: {\n            currentPage: validatedParams.page,\n            totalPages,\n            totalCount,\n            hasNextPage: validatedParams.page < totalPages,\n            hasPreviousPage: validatedParams.page > 1,\n        },\n    };\n}\n\nexport async function getUserApplications(profileId: string) {\n    const parsed = z.object({ profileId: z.string().uuid() }).safeParse({ profileId });\n    if (!parsed.success) {\n        throw new Error(\"Invalid profile ID\");\n    }\n\n    const applications = await prisma.application.findMany({\n        where: { profileId },\n        include: {\n            references: true,\n        },\n        orderBy: { createdAt: 'desc' }\n    });\n\n    return applications;\n}\n\n// Form action wrapper for updateApplicationStatus\nexport async function updateApplicationStatusForm(formData: FormData) {\n  return updateApplicationStatus(ok(null), formData);\n}\n\nconst bulkUpdateSchema = z.object({\n  appIds: z.array(z.coerce.number().int().positive({ message: \"Invalid application ID\" })),\n  status: z.nativeEnum(AppStatus, { message: \"Invalid status\" }),\n  statusNotes: z.string().optional(),\n});\n\nexport async function bulkUpdateApplicationStatus(\n  appIds: number[],\n  status: AppStatus,\n  statusNotes?: string\n): Promise<ActionResult<{ ok: number[]; failed: { id: number; reason: string }[] }>> {\n  try {\n    await assertRole(UserRole.STAFF);\n\n    const parsed = bulkUpdateSchema.safeParse({ appIds, status, statusNotes });\n    if (!parsed.success) {\n      const fieldErrors = parsed.error.flatten().fieldErrors;\n      return fail(\"Validation failed.\", fieldErrors);\n    }\n\n    // Business rule: notes required for APPROVED/REJECTED/WITHDRAWN\n    const requiresNotes: AppStatus[] = [AppStatus.APPROVED, AppStatus.REJECTED, AppStatus.WITHDRAWN]\n    if (requiresNotes.includes(status) && (!statusNotes || statusNotes.trim().length === 0)) {\n      return fail(\"Status notes are required when moving to approved, rejected, or withdrawn status.\", { statusNotes: [\"Required for terminal status changes\"] });\n    }\n\n    // Get current user for authentication\n    const supabase = await createClient();\n    const { data: { user: updater } } = await supabase.auth.getUser();\n    if (!updater) {\n      return fail(\"Authentication required.\");\n    }\n\n    // Get updater's role from database\n    const updaterProfile = await prisma.profile.findUnique({\n      where: { id: updater.id },\n      select: { role: true },\n    });\n\n    if (!updaterProfile || (updaterProfile.role !== UserRole.ADMIN && updaterProfile.role !== UserRole.STAFF)) {\n      return fail(\"Insufficient permissions.\");\n    }\n\n    // Get current applications to validate status transitions\n    const currentApplications = await prisma.application.findMany({\n      where: { id: { in: appIds } },\n      select: {\n        id: true,\n        status: true,\n        applicationType: true,\n      },\n    });\n\n    const appMap = new Map(currentApplications.map(app => [app.id, app]));\n    const successfulIds: number[] = [];\n    const failed: { id: number; reason: string }[] = [];\n\n    // Validate each transition and collect failures\n    for (const appId of appIds) {\n      const currentApp = appMap.get(appId);\n      if (!currentApp) {\n        failed.push({ id: appId, reason: \"Application not found\" });\n        continue;\n      }\n\n      // Validate that the status transition is allowed\n      const allowedStatuses = getAllowedStatuses(currentApp.applicationType, currentApp.status);\n      if (!allowedStatuses.includes(status)) {\n        failed.push({\n          id: appId,\n          reason: `Invalid status transition from ${currentApp.status} for ${currentApp.applicationType} application`\n        });\n        continue;\n      }\n\n      successfulIds.push(appId);\n    }\n\n    // Update successful applications and write audit records\n    if (successfulIds.length > 0) {\n      await prisma.$transaction(async (tx) => {\n        // Update applications\n        await tx.application.updateMany({\n          where: { id: { in: successfulIds } },\n          data: {\n            status,\n            statusNotes: statusNotes || null,\n          },\n        });\n\n        // Write to append-only ApplicationAudit table for each updated application\n        await tx.applicationAudit.createMany({\n          data: successfulIds.map(appId => {\n            const currentApp = appMap.get(appId)!;\n            return {\n              applicationId: appId,\n              actorId: updater.id,\n              oldStatus: currentApp.status,\n              newStatus: status,\n              note: statusNotes || `Bulk status change from ${currentApp.status} to ${status}`,\n            };\n          }),\n        });\n      });\n\n      // Revalidate on success\n      revalidatePath(\"/admin/applications\");\n    }\n\n    return ok({ ok: successfulIds, failed }, `Updated ${successfulIds.length} application${successfulIds.length !== 1 ? 's' : ''} successfully${failed.length > 0 ? `, ${failed.length} failed` : ''}.`);\n  } catch (error) {\n    return fail(error instanceof Error ? error.message : \"An unexpected error occurred.\");\n  }\n}\n\nexport async function getApplicationHistory(applicationId: number): Promise<ApplicationHistoryEntry[]> {\n  await assertRole([UserRole.ADMIN, UserRole.STAFF]);\n\n  const history = await prisma.applicationAudit.findMany({\n    where: { applicationId },\n    select: {\n      id: true,\n      applicationId: true,\n      oldStatus: true,\n      newStatus: true,\n      note: true,\n      createdAt: true,\n      actor: {\n        select: {\n          name: true,\n          email: true,\n        },\n      },\n    },\n    orderBy: { createdAt: \"desc\" },\n  });\n\n  return history as ApplicationHistoryEntry[];\n}\n\n// Server actions for useActionState (form-based)\nexport async function bulkAssignApplications(\n  prevState: ActionResult,\n  formData: FormData\n): Promise<ActionResult> {\n  try {\n    await assertRole([UserRole.ADMIN, UserRole.STAFF]);\n\n    const applicationIds = formData.getAll(\"applicationIds\").map(id => parseInt(id as string));\n    const staffId = formData.get(\"staffId\") as string;\n\n    if (!staffId || applicationIds.length === 0) {\n      return fail(\"Staff member and applications are required\");\n    }\n\n    // Verify staff user exists\n    const staffUser = await prisma.profile.findUnique({\n      where: { id: staffId },\n      select: { id: true, role: true },\n    });\n\n    if (!staffUser || (staffUser.role !== UserRole.STAFF && staffUser.role !== UserRole.ADMIN)) {\n      return fail(\"Invalid staff member selected\");\n    }\n\n    // Perform bulk update\n    const updateResult = await prisma.application.updateMany({\n      where: {\n        id: { in: applicationIds },\n      },\n      data: {\n        assignedToUserId: staffId,\n        updatedAt: new Date(),\n      },\n    });\n\n    revalidatePath(\"/admin/applications\");\n\n    return ok(null, `Successfully assigned ${updateResult.count} application(s)`);\n\n  } catch (error) {\n    console.error(\"Bulk assign error:\", error);\n    return fail(error instanceof Error ? error.message : \"Failed to assign applications\");\n  }\n}\n\nexport async function bulkUpdateApplications(\n  prevState: ActionResult<{ failed?: { id: number; reason: string }[] }>,\n  formData: FormData\n): Promise<ActionResult<{ failed?: { id: number; reason: string }[] }>> {\n  try {\n    await assertRole([UserRole.ADMIN, UserRole.STAFF]);\n\n    const applicationIds = parseApplicationIds(formData);\n    const status = formData.get(\"status\") as AppStatus;\n    const statusNotes = formData.get(\"statusNotes\") as string;\n\n    if (applicationIds.length === 0) {\n      return fail(\"No applications selected\");\n    }\n\n    if (!status) {\n      return fail(\"Status is required\");\n    }\n\n    // Business rule: notes required for APPROVED/REJECTED/WITHDRAWN\n    const requiresNotes: AppStatus[] = [AppStatus.APPROVED, AppStatus.REJECTED, AppStatus.WITHDRAWN];\n    if (requiresNotes.includes(status) && (!statusNotes || statusNotes.trim().length === 0)) {\n      return fail(\"Status notes are required for terminal status changes\");\n    }\n\n    const result = await bulkUpdateApplicationStatus(\n      applicationIds,\n      status,\n      statusNotes?.trim() || undefined\n    );\n\n    if (result.success) {\n      const successCount = result.data?.ok.length || 0;\n\n      revalidatePath(\"/admin/applications\");\n\n      return ok({ failed: result.data?.failed }, `Successfully updated ${successCount} application(s)`);\n    } else {\n      return fail(result.message || \"Bulk update failed\");\n    }\n\n  } catch (error) {\n    console.error(\"Bulk update error:\", error);\n    return fail(error instanceof Error ? error.message : \"Failed to update applications\");\n  }\n}\n\nexport async function exportApplicationsCSV(\n  searchParams: { [key: string]: string | undefined },\n  minimal: boolean\n): Promise<{ success: true; csvData: string; filename: string } | { success: false; message: string }> {\n  try {\n    await assertRole(UserRole.STAFF);\n\n    const filters = { ...searchParams };\n    delete filters.minimal; // Remove minimal param from filters\n\n    const appData = await getAllApplications(filters);\n    const applications: ApplicationListItem[] = appData.applications;\n\n    // Guard against exporting insane data sets\n    const MAX_EXPORT_ROWS = 10000;\n    if (applications.length > MAX_EXPORT_ROWS) {\n      return {\n        success: false,\n        message: `Export too large: ${applications.length} applications found, maximum allowed is ${MAX_EXPORT_ROWS}. Please apply filters to reduce the dataset size.`\n      };\n    }\n\n    // Generate CSV data\n    let csvData: Record<string, unknown>[];\n    let csvHeaders: string[];\n\n    if (minimal) {\n      // Minimal export: no PII (phone/address)\n      csvData = applications.map(app => ({\n        id: app.id,\n        submitted_date: app.createdAt.toISOString().split('T')[0],\n        name: missing(app.applicantName, 'Unknown'),\n        email: missing(app.applicantEmail, 'Unknown'),\n        type: app.applicationType,\n        status: app.status,\n        dog_name: app.dog?.name || '',\n        reason: app.reason,\n      }));\n      csvHeaders = [\n        'ID', 'Submitted Date', 'Name', 'Email', 'Type', 'Status',\n        'Dog Name', 'Reason'\n      ];\n    } else {\n      // Full export with available fields\n      csvData = applications.map(app => ({\n        id: app.id,\n        submitted_date: app.createdAt.toISOString().split('T')[0],\n        name: missing(app.applicantName, 'Unknown'),\n        email: missing(app.applicantEmail, 'Unknown'),\n        type: app.applicationType,\n        status: app.status,\n        dog_name: app.dog?.name || '',\n        reason: app.reason,\n      }));\n      csvHeaders = [\n        'ID', 'Submitted Date', 'Name', 'Email', 'Type', 'Status',\n        'Dog Name', 'Reason'\n      ];\n    }\n\n    const csvWithBOM = toCsv(csvData, csvHeaders);\n    const filename = `applications-${new Date().toISOString().split('T')[0]}${minimal ? '-minimal' : ''}.csv`;\n\n    return {\n      success: true,\n      csvData: csvWithBOM,\n      filename\n    };\n  } catch (error) {\n    console.error('CSV export error:', error);\n    return {\n      success: false,\n      message: error instanceof Error ? error.message : 'Failed to generate export'\n    };\n  }\n}\n"],"names":[],"mappings":";;;;;;;IA6CsB,oBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA","debugId":null}},
    {"offset": {"line": 19, "column": 0}, "map": {"version":3,"sources":["file:///Users/adampeterson/Github/mutts/lib/types.ts"],"sourcesContent":["// lib/types.ts\n\n/**\n * Result type for server actions - follows Railway-oriented programming pattern\n */\nexport type Result<T, E = Error> = { success: true; data: T } | { success: false; error: E };\n\n/**\n * Canonical action result type for server actions\n */\nexport type ActionResult<T = null> = {\n  data: T | null;\n  success: boolean;\n  message: string | null;\n  fieldErrors?: Record<string, string[]>;\n};\n\n/**\n * Helper constructor for successful ActionResult\n */\nexport function ok<T = null>(data: T, message: string | null = null): ActionResult<T> {\n  return {\n    success: true,\n    message,\n    data,\n    fieldErrors: undefined,\n  };\n}\n\n/**\n * Helper constructor for failed ActionResult\n */\nexport function fail<T = null>(message: string, fieldErrors?: Record<string, string[]>): ActionResult<T> {\n  return {\n    success: false,\n    message,\n    data: null,\n    fieldErrors,\n  } as ActionResult<T>;\n}\n\n/**\n * Helper constructor for ActionResult with default values\n */\nexport function makeActionResult<T>(overrides?: Partial<ActionResult<T>>): ActionResult<T> {\n  return {\n    success: false,\n    message: null,\n    data: null,\n    fieldErrors: undefined,\n    ...overrides,\n  };\n}\n\n/**\n * Canonical dog list item for admin tables and listings\n */\nexport interface DogListItem {\n  id: number;\n  mutt_id: string | null;\n  name: string;\n  breed: string | null;\n  dateOfBirth: Date | null;\n  gender: import(\"@prisma/client\").Gender | null;\n  size: import(\"@prisma/client\").DogSize | null;\n  weight_lbs: number | null;\n  primaryPhotoUrl: string | null;\n  specialNeeds: boolean;\n  bioPublic: string | null;\n  status: import(\"@prisma/client\").DogStatus;\n  fosterProfile?: {\n    name: string | null;\n    email: string;\n  } | null;\n}\n\n/**\n * Public dog list item for adopt page with derived fields\n */\nexport interface PublicDogListItem extends Omit<DogListItem, 'gender' | 'mutt_id'> {\n  gender: import(\"@prisma/client\").Gender;\n  mutt_id: string | null;\n  isSenior: boolean;\n  hasPhotos: boolean;\n}\n\n/**\n * Canonical pagination metadata\n */\nexport interface PaginationMeta {\n  currentPage: number;\n  totalPages: number;\n  totalCount: number;\n  hasNextPage: boolean;\n  hasPreviousPage: boolean;\n}\n"],"names":[],"mappings":"AAAA,eAAe;AAEf;;CAEC;;;;;;;;AAgBM,SAAS,GAAa,IAAO,EAAE,UAAyB,IAAI;IACjE,OAAO;QACL,SAAS;QACT;QACA;QACA,aAAa;IACf;AACF;AAKO,SAAS,KAAe,OAAe,EAAE,WAAsC;IACpF,OAAO;QACL,SAAS;QACT;QACA,MAAM;QACN;IACF;AACF;AAKO,SAAS,iBAAoB,SAAoC;IACtE,OAAO;QACL,SAAS;QACT,SAAS;QACT,MAAM;QACN,aAAa;QACb,GAAG,SAAS;IACd;AACF","debugId":null}},
    {"offset": {"line": 62, "column": 0}, "map": {"version":3,"sources":["file:///Users/adampeterson/Github/mutts/lib/utils/index.ts"],"sourcesContent":["// lib/utils/index.ts\n// Shared utility functions for the application\n\nimport { AppStatus, AppType } from \"@prisma/client\";\n\n/**\n * Humanize enum values by replacing underscores with spaces and capitalizing words\n */\nexport const humanizeEnum = (value: string): string => {\n  return value\n    .toLowerCase()\n    .replace(/_/g, ' ')\n    .replace(/\\b\\w/g, l => l.toUpperCase());\n};\n\n/**\n * Status variant functions for consistent badge styling\n */\nexport const getAppStatusVariant = (status: AppStatus) => {\n  switch (status) {\n    case \"APPROVED\": return \"default\";\n    case \"SUBMITTED\": case \"IN_REVIEW\": return \"secondary\";\n    case \"REJECTED\": return \"destructive\";\n    default: return \"outline\";\n  }\n};\n\n/**\n * Get allowed status transitions for applications\n */\nexport const getAllowedStatuses = (applicationType: AppType, currentStatus?: AppStatus): AppStatus[] => {\n  const allStatuses = Object.values(AppStatus);\n\n  // For foster applications, restrict some status transitions\n  if (applicationType === AppType.FOSTER) {\n    // Fosters can be approved (creates foster profile) or rejected\n    // Can't be marked as \"IN_REVIEW\" inappropriately\n    return allStatuses.filter(status =>\n      status !== AppStatus.IN_REVIEW || currentStatus === AppStatus.IN_REVIEW\n    );\n  }\n\n  // For adoption applications, all statuses are allowed\n  return allStatuses;\n};\n\n/**\n * Check if status change notes are required for a given status\n */\nexport const areStatusNotesRequired = (status: AppStatus): boolean => {\n  return status === AppStatus.APPROVED || status === AppStatus.REJECTED;\n};\n"],"names":[],"mappings":"AAAA,qBAAqB;AACrB,+CAA+C;;;;;;;;;;;AAE/C;;AAKO,MAAM,eAAe,CAAC;IAC3B,OAAO,MACJ,WAAW,GACX,OAAO,CAAC,MAAM,KACd,OAAO,CAAC,SAAS,CAAA,IAAK,EAAE,WAAW;AACxC;AAKO,MAAM,sBAAsB,CAAC;IAClC,OAAQ;QACN,KAAK;YAAY,OAAO;QACxB,KAAK;QAAa,KAAK;YAAa,OAAO;QAC3C,KAAK;YAAY,OAAO;QACxB;YAAS,OAAO;IAClB;AACF;AAKO,MAAM,qBAAqB,CAAC,iBAA0B;IAC3D,MAAM,cAAc,OAAO,MAAM,CAAC,sKAAS;IAE3C,4DAA4D;IAC5D,IAAI,oBAAoB,oKAAO,CAAC,MAAM,EAAE;QACtC,+DAA+D;QAC/D,iDAAiD;QACjD,OAAO,YAAY,MAAM,CAAC,CAAA,SACxB,WAAW,sKAAS,CAAC,SAAS,IAAI,kBAAkB,sKAAS,CAAC,SAAS;IAE3E;IAEA,sDAAsD;IACtD,OAAO;AACT;AAKO,MAAM,yBAAyB,CAAC;IACrC,OAAO,WAAW,sKAAS,CAAC,QAAQ,IAAI,WAAW,sKAAS,CAAC,QAAQ;AACvE","debugId":null}},
    {"offset": {"line": 113, "column": 0}, "map": {"version":3,"sources":["file:///Users/adampeterson/Github/mutts/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\";\nimport { twMerge } from \"tailwind-merge\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { AppStatus, AppType, DogStatus } from \"@prisma/client\";\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n\n\n// This check can be removed, it is just for tutorial purposes\nexport const hasEnvVars =\n  !!(process.env.NEXT_PUBLIC_SUPABASE_URL &&\n     process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY);\n\n\nexport const getDogStatusVariant = (status: DogStatus) => {\n  switch (status) {\n    case \"ADOPTED\": return \"default\";\n    case \"AVAILABLE\": return \"secondary\";\n    case \"MEDICAL_HOLD\": return \"destructive\";\n    case \"PENDING\": case \"IN_FOSTER\": return \"outline\";\n    default: return \"secondary\";\n  }\n};\n\n// Date formatting utilities\nexport const formatDateTime = (date: Date) =>\n  new Intl.DateTimeFormat(\"en-US\", {\n    month: \"short\",\n    day: \"numeric\",\n    year: \"numeric\",\n    hour: \"numeric\",\n    minute: \"2-digit\",\n  }).format(date);\n\nexport const formatDateRange = (start: Date, end: Date) => {\n  const sameDay =\n    start.getFullYear() === end.getFullYear() &&\n    start.getMonth() === end.getMonth() &&\n    start.getDate() === end.getDate();\n\n  if (sameDay) {\n    return `${formatDateTime(start)} – ${new Intl.DateTimeFormat(\"en-US\", {\n      hour: \"numeric\",\n      minute: \"2-digit\",\n    }).format(end)}`;\n  }\n\n  return `${formatDateTime(start)} → ${formatDateTime(end)}`;\n};\n\nexport const formatShiftTime = (start: Date, end: Date): string => {\n  const startDate = start.toLocaleDateString();\n  const startTime = start.toLocaleTimeString([], { hour: 'numeric', minute: '2-digit' });\n  const endTime = end.toLocaleTimeString([], { hour: 'numeric', minute: '2-digit' });\n\n  if (startDate === end.toLocaleDateString()) {\n    return `${startDate}, ${startTime} - ${endTime}`;\n  }\n  return `${startDate}, ${startTime} - ${end.toLocaleDateString()}, ${endTime}`;\n};\n\nexport const formatAdoptionDate = (date: Date) =>\n  new Intl.DateTimeFormat(\"en-US\", {\n    year: \"numeric\",\n    month: \"long\",\n    day: \"numeric\",\n  }).format(date);\n\n// Re-export shared utilities\nexport { humanizeEnum, getAppStatusVariant, getAllowedStatuses, areStatusNotesRequired } from './utils/index';\n\n// Test endpoint validation - allow in test environment or with test secret header\nexport function validateTestEndpoint(request: Request): { isValid: boolean; response?: Response } {\n  const isTestEnv = process.env.NODE_ENV === 'test' && process.env.EXPOSE_TEST_API === '1';\n\n  const testSecret = request.headers.get('x-test-secret');\n  const expectedSecret = process.env.TEST_SECRET || 'test-secret-default';\n  const hasValidTestSecret = testSecret === expectedSecret;\n\n  if (!isTestEnv || !hasValidTestSecret) {\n    return {\n      isValid: false,\n      response: new Response(null, { status: 404 })\n    };\n  }\n\n  return { isValid: true };\n}\n\n// Route definitions have been moved to lib/routes.ts\n// Import route functions from @/lib/routes instead\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAYK;AAZL;AACA;AAqEA,6BAA6B;AAC7B;;;AAlEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,yKAAO,EAAC,IAAA,gJAAI,EAAC;AACtB;AAIO,MAAM,aACX,CAAC,CAAC,CAAC,kKACyC;AAGvC,MAAM,sBAAsB,CAAC;IAClC,OAAQ;QACN,KAAK;YAAW,OAAO;QACvB,KAAK;YAAa,OAAO;QACzB,KAAK;YAAgB,OAAO;QAC5B,KAAK;QAAW,KAAK;YAAa,OAAO;QACzC;YAAS,OAAO;IAClB;AACF;AAGO,MAAM,iBAAiB,CAAC,OAC7B,IAAI,KAAK,cAAc,CAAC,SAAS;QAC/B,OAAO;QACP,KAAK;QACL,MAAM;QACN,MAAM;QACN,QAAQ;IACV,GAAG,MAAM,CAAC;AAEL,MAAM,kBAAkB,CAAC,OAAa;IAC3C,MAAM,UACJ,MAAM,WAAW,OAAO,IAAI,WAAW,MACvC,MAAM,QAAQ,OAAO,IAAI,QAAQ,MACjC,MAAM,OAAO,OAAO,IAAI,OAAO;IAEjC,IAAI,SAAS;QACX,OAAO,GAAG,eAAe,OAAO,GAAG,EAAE,IAAI,KAAK,cAAc,CAAC,SAAS;YACpE,MAAM;YACN,QAAQ;QACV,GAAG,MAAM,CAAC,MAAM;IAClB;IAEA,OAAO,GAAG,eAAe,OAAO,GAAG,EAAE,eAAe,MAAM;AAC5D;AAEO,MAAM,kBAAkB,CAAC,OAAa;IAC3C,MAAM,YAAY,MAAM,kBAAkB;IAC1C,MAAM,YAAY,MAAM,kBAAkB,CAAC,EAAE,EAAE;QAAE,MAAM;QAAW,QAAQ;IAAU;IACpF,MAAM,UAAU,IAAI,kBAAkB,CAAC,EAAE,EAAE;QAAE,MAAM;QAAW,QAAQ;IAAU;IAEhF,IAAI,cAAc,IAAI,kBAAkB,IAAI;QAC1C,OAAO,GAAG,UAAU,EAAE,EAAE,UAAU,GAAG,EAAE,SAAS;IAClD;IACA,OAAO,GAAG,UAAU,EAAE,EAAE,UAAU,GAAG,EAAE,IAAI,kBAAkB,GAAG,EAAE,EAAE,SAAS;AAC/E;AAEO,MAAM,qBAAqB,CAAC,OACjC,IAAI,KAAK,cAAc,CAAC,SAAS;QAC/B,MAAM;QACN,OAAO;QACP,KAAK;IACP,GAAG,MAAM,CAAC;;AAML,SAAS,qBAAqB,OAAgB;IACnD,MAAM,YAAY,oDAAyB,UAAU,2KAAO,CAAC,GAAG,CAAC,eAAe,KAAK;IAErF,MAAM,aAAa,QAAQ,OAAO,CAAC,GAAG,CAAC;IACvC,MAAM,iBAAiB,2KAAO,CAAC,GAAG,CAAC,WAAW,IAAI;IAClD,MAAM,qBAAqB,eAAe;IAE1C,wCAAuC;QACrC,OAAO;YACL,SAAS;YACT,UAAU,IAAI,SAAS,MAAM;gBAAE,QAAQ;YAAI;QAC7C;IACF;;;AAGF,EAEA,qDAAqD;CACrD,mDAAmD","debugId":null}},
    {"offset": {"line": 219, "column": 0}, "map": {"version":3,"sources":["file:///Users/adampeterson/Github/mutts/components/ui/label.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Label({\n  className,\n  ...props\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\n  return (\n    <LabelPrimitive.Root\n      data-slot=\"label\"\n      className={cn(\n        \"flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Label }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,MAAM,EACb,SAAS,EACT,GAAG,OAC8C;IACjD,qBACE,6LAAC,4KAAmB;QAClB,aAAU;QACV,WAAW,IAAA,qIAAE,EACX,uNACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS","debugId":null}},
    {"offset": {"line": 252, "column": 0}, "map": {"version":3,"sources":["file:///Users/adampeterson/Github/mutts/components/ui/input.tsx"],"sourcesContent":["import * as React from \"react\";\n\nimport { cn } from \"@/lib/utils\";\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className,\n        )}\n        ref={ref}\n        {...props}\n      />\n    );\n  },\n);\nInput.displayName = \"Input\";\n\nexport { Input };\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAEA,MAAM,sBAAQ,2KAAgB,MAC5B,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;IAC9B,qBACE,6LAAC;QACC,MAAM;QACN,WAAW,IAAA,qIAAE,EACX,2WACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,MAAM,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 287, "column": 0}, "map": {"version":3,"sources":["file:///Users/adampeterson/Github/mutts/components/ui/form-error.tsx"],"sourcesContent":["// components/ui/form-error.tsx\nexport function FormError({ error }: { error: string | string[] | undefined }) {\n  if (!error) return null;\n  const errorMessage = Array.isArray(error) ? error.join(\", \") : error;\n  return (\n    <p\n      className=\"text-red-500 text-sm mt-1 motion-reduce:animate-none animate-shake\"\n      role=\"alert\"\n      aria-live=\"assertive\"\n    >\n      {errorMessage}\n    </p>\n  );\n}\n"],"names":[],"mappings":"AAAA,+BAA+B;;;;;;;AACxB,SAAS,UAAU,EAAE,KAAK,EAA4C;IAC3E,IAAI,CAAC,OAAO,OAAO;IACnB,MAAM,eAAe,MAAM,OAAO,CAAC,SAAS,MAAM,IAAI,CAAC,QAAQ;IAC/D,qBACE,6LAAC;QACC,WAAU;QACV,MAAK;QACL,aAAU;kBAET;;;;;;AAGP;KAZgB","debugId":null}},
    {"offset": {"line": 318, "column": 0}, "map": {"version":3,"sources":["file:///Users/adampeterson/Github/mutts/app/apply/_components/form-sections/ContactInfoSection.tsx"],"sourcesContent":["import { Label } from \"@/components/ui/label\";\nimport { Input } from \"@/components/ui/input\";\nimport { FormError } from \"@/components/ui/form-error\";\n\n\ninterface ContactInfoSectionProps {\n  errors?: Record<string, string[]> | null;\n  savedData?: Record<string, unknown> | null;\n  previousData?: Record<string, unknown> | null;\n  userProfile?: { name?: string; email?: string } | null;\n}\n\nexport default function ContactInfoSection({ errors, savedData, previousData }: ContactInfoSectionProps) {\n  // Helper to get value with priority: savedData > previousData\n  const getValue = (key: string) => {\n    return (savedData?.[key] as string) || (previousData?.[key] as string) || \"\";\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <div>\n        <Label htmlFor=\"firstName\">First Name</Label>\n        <Input\n          id=\"firstName\"\n          name=\"firstName\"\n          placeholder=\"Your first name\"\n          defaultValue={getValue(\"firstName\")}\n          data-testid=\"field-first-name\"\n        />\n        <FormError error={errors?.firstName} />\n      </div>\n\n      <div>\n        <Label htmlFor=\"lastName\">Last Name</Label>\n        <Input\n          id=\"lastName\"\n          name=\"lastName\"\n          placeholder=\"Your last name\"\n          defaultValue={getValue(\"lastName\")}\n          data-testid=\"field-last-name\"\n        />\n        <FormError error={errors?.lastName} />\n      </div>\n\n      <div>\n        <Label htmlFor=\"email\">Email Address</Label>\n        <Input\n          id=\"email\"\n          name=\"email\"\n          type=\"email\"\n          placeholder=\"your.email@example.com\"\n          defaultValue={getValue(\"email\")}\n          data-testid=\"field-email\"\n        />\n        <FormError error={errors?.email} />\n      </div>\n\n      <div>\n        <Label htmlFor=\"applicantPhone\">Phone Number (Optional)</Label>\n        <Input\n          id=\"applicantPhone\"\n          name=\"applicantPhone\"\n          type=\"tel\"\n          placeholder=\"(123) 456-7890\"\n          defaultValue={getValue(\"applicantPhone\")}\n          data-testid=\"input-phone\"\n        />\n        <p className=\"text-sm text-muted-foreground mt-1\">\n          In case we need to reach you quickly.\n        </p>\n        <FormError error={errors?.applicantPhone} />\n      </div>\n\n      <div>\n        <Label htmlFor=\"address\">Street Address</Label>\n        <Input\n          id=\"address\"\n          name=\"address\"\n          placeholder=\"123 Main St, Anytown CA 90210\"\n          defaultValue={getValue(\"address\")}\n          data-testid=\"input-address\"\n        />\n        <FormError error={errors?.address} />\n      </div>\n\n      <div>\n        <Label htmlFor=\"vetName\">Current or Previous Veterinarian (Optional)</Label>\n        <Input\n          id=\"vetName\"\n          name=\"vetName\"\n          placeholder=\"Vet Name / Clinic Name\"\n          defaultValue={getValue(\"vetName\")}\n        />\n        <FormError error={errors?.vetName} />\n      </div>\n\n      <div>\n        <Label htmlFor=\"vetPhone\">Veterinarian Phone (Optional)</Label>\n        <Input\n          id=\"vetPhone\"\n          name=\"vetPhone\"\n          type=\"tel\"\n          placeholder=\"Vet's phone number\"\n          defaultValue={getValue(\"vetPhone\")}\n        />\n        <p className=\"text-sm text-muted-foreground mt-1\">\n          We may contact them for a reference.\n        </p>\n        <FormError error={errors?.vetPhone} />\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;;AAUe,SAAS,mBAAmB,EAAE,MAAM,EAAE,SAAS,EAAE,YAAY,EAA2B;IACrG,8DAA8D;IAC9D,MAAM,WAAW,CAAC;QAChB,OAAO,AAAC,WAAW,CAAC,IAAI,IAAgB,cAAc,CAAC,IAAI,IAAe;IAC5E;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;;kCACC,6LAAC,sIAAK;wBAAC,SAAQ;kCAAY;;;;;;kCAC3B,6LAAC,sIAAK;wBACJ,IAAG;wBACH,MAAK;wBACL,aAAY;wBACZ,cAAc,SAAS;wBACvB,eAAY;;;;;;kCAEd,6LAAC,kJAAS;wBAAC,OAAO,QAAQ;;;;;;;;;;;;0BAG5B,6LAAC;;kCACC,6LAAC,sIAAK;wBAAC,SAAQ;kCAAW;;;;;;kCAC1B,6LAAC,sIAAK;wBACJ,IAAG;wBACH,MAAK;wBACL,aAAY;wBACZ,cAAc,SAAS;wBACvB,eAAY;;;;;;kCAEd,6LAAC,kJAAS;wBAAC,OAAO,QAAQ;;;;;;;;;;;;0BAG5B,6LAAC;;kCACC,6LAAC,sIAAK;wBAAC,SAAQ;kCAAQ;;;;;;kCACvB,6LAAC,sIAAK;wBACJ,IAAG;wBACH,MAAK;wBACL,MAAK;wBACL,aAAY;wBACZ,cAAc,SAAS;wBACvB,eAAY;;;;;;kCAEd,6LAAC,kJAAS;wBAAC,OAAO,QAAQ;;;;;;;;;;;;0BAG5B,6LAAC;;kCACC,6LAAC,sIAAK;wBAAC,SAAQ;kCAAiB;;;;;;kCAChC,6LAAC,sIAAK;wBACJ,IAAG;wBACH,MAAK;wBACL,MAAK;wBACL,aAAY;wBACZ,cAAc,SAAS;wBACvB,eAAY;;;;;;kCAEd,6LAAC;wBAAE,WAAU;kCAAqC;;;;;;kCAGlD,6LAAC,kJAAS;wBAAC,OAAO,QAAQ;;;;;;;;;;;;0BAG5B,6LAAC;;kCACC,6LAAC,sIAAK;wBAAC,SAAQ;kCAAU;;;;;;kCACzB,6LAAC,sIAAK;wBACJ,IAAG;wBACH,MAAK;wBACL,aAAY;wBACZ,cAAc,SAAS;wBACvB,eAAY;;;;;;kCAEd,6LAAC,kJAAS;wBAAC,OAAO,QAAQ;;;;;;;;;;;;0BAG5B,6LAAC;;kCACC,6LAAC,sIAAK;wBAAC,SAAQ;kCAAU;;;;;;kCACzB,6LAAC,sIAAK;wBACJ,IAAG;wBACH,MAAK;wBACL,aAAY;wBACZ,cAAc,SAAS;;;;;;kCAEzB,6LAAC,kJAAS;wBAAC,OAAO,QAAQ;;;;;;;;;;;;0BAG5B,6LAAC;;kCACC,6LAAC,sIAAK;wBAAC,SAAQ;kCAAW;;;;;;kCAC1B,6LAAC,sIAAK;wBACJ,IAAG;wBACH,MAAK;wBACL,MAAK;wBACL,aAAY;wBACZ,cAAc,SAAS;;;;;;kCAEzB,6LAAC;wBAAE,WAAU;kCAAqC;;;;;;kCAGlD,6LAAC,kJAAS;wBAAC,OAAO,QAAQ;;;;;;;;;;;;;;;;;;AAIlC;KApGwB","debugId":null}},
    {"offset": {"line": 610, "column": 0}, "map": {"version":3,"sources":["file:///Users/adampeterson/Github/mutts/components/ui/textarea.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Textarea({ className, ...props }: React.ComponentProps<\"textarea\">) {\n  return (\n    <textarea\n      data-slot=\"textarea\"\n      className={cn(\n        \"border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Textarea }\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,SAAS,EAAE,SAAS,EAAE,GAAG,OAAyC;IACzE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qIAAE,EACX,ucACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS","debugId":null}},
    {"offset": {"line": 640, "column": 0}, "map": {"version":3,"sources":["file:///Users/adampeterson/Github/mutts/components/ui/checkbox.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\";\nimport { Check } from \"lucide-react\";\n\nimport { cn } from \"@/lib/utils\";\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className,\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n));\nCheckbox.displayName = CheckboxPrimitive.Root.displayName;\n\nexport { Checkbox };\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,yBAAW,2KAAgB,MAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,+KAAsB;QACrB,KAAK;QACL,WAAW,IAAA,qIAAE,EACX,sQACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,oLAA2B;YAC1B,WAAW,IAAA,qIAAE,EAAC;sBAEd,cAAA,6LAAC,gNAAK;gBAAC,WAAU;;;;;;;;;;;;;;;;;AAIvB,SAAS,WAAW,GAAG,+KAAsB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 691, "column": 0}, "map": {"version":3,"sources":["file:///Users/adampeterson/Github/mutts/app/apply/_components/form-sections/FosterSpecificSection.tsx"],"sourcesContent":["import { Label } from \"@/components/ui/label\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { FormError } from \"@/components/ui/form-error\";\n\nfunction FieldError({ error }: { error: string[] | undefined }) {\n  if (!error || error.length === 0) return null;\n  return <p className=\"text-red-500 text-sm mt-1\">{error[0]}</p>;\n}\n\ninterface FosterSpecificSectionProps {\n  errors?: Record<string, string[]> | null;\n  savedData?: Record<string, unknown> | null;\n  previousData?: Record<string, unknown> | null;\n}\n\nexport default function FosterSpecificSection({ errors, savedData, previousData }: FosterSpecificSectionProps) {\n  // Helper to get value with priority: savedData > previousData\n  const getValue = (key: string) => {\n    return (savedData?.[key] as string) || (previousData?.[key] as string) || \"\";\n  };\n\n  const getBooleanValue = (key: string) => {\n    return (savedData?.[key] as boolean) || (previousData?.[key] as boolean) || false;\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <h3 className=\"text-lg font-semibold\">Foster-Specific Information</h3>\n\n      <div>\n        <Label htmlFor=\"fosterCapacity\">How many dogs can you foster at one time?</Label>\n        <Input\n          id=\"fosterCapacity\"\n          name=\"fosterCapacity\"\n          type=\"number\"\n          min=\"1\"\n          max=\"10\"\n          placeholder=\"1\"\n          defaultValue={getValue(\"fosterCapacity\")}\n          data-testid=\"input-foster-capacity\"\n          className=\"mt-2\"\n        />\n        <p className=\"text-sm text-muted-foreground mt-1\">\n          Most fosters start with 1-2 dogs, but let us know your capacity.\n        </p>\n        <FormError error={errors?.fosterCapacity} />\n      </div>\n\n      <div>\n        <Label>Do you have experience with animals?</Label>\n        <div className=\"space-y-3 mt-2\">\n          <div className=\"flex items-center space-x-2\">\n            <Checkbox\n              id=\"hasCats\"\n              name=\"hasCats\"\n              defaultChecked={getBooleanValue(\"hasCats\")}\n              data-testid=\"checkbox-has-cats\"\n            />\n            <Label htmlFor=\"hasCats\" className=\"font-normal\">\n              I have cats\n            </Label>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <Checkbox\n              id=\"hasDogs\"\n              name=\"hasDogs\"\n              defaultChecked={getBooleanValue(\"hasDogs\")}\n              data-testid=\"checkbox-has-dogs\"\n            />\n            <Label htmlFor=\"hasDogs\" className=\"font-normal\">\n              I have dogs\n            </Label>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <Checkbox\n              id=\"canAdministerMeds\"\n              name=\"canAdministerMeds\"\n              defaultChecked={getBooleanValue(\"canAdministerMeds\")}\n              data-testid=\"checkbox-can-administer-meds\"\n            />\n            <Label htmlFor=\"canAdministerMeds\" className=\"font-normal\">\n              I can administer medications\n            </Label>\n          </div>\n        </div>\n        <FieldError error={errors?.hasCats || errors?.hasDogs || errors?.canAdministerMeds} />\n      </div>\n\n      <div>\n        <Label htmlFor=\"experience\">Tell us about your experience with animals</Label>\n        <Textarea\n          id=\"experience\"\n          name=\"experience\"\n          placeholder=\"Years of experience, types of animals, etc.\"\n          defaultValue={getValue(\"experience\")}\n          data-testid=\"textarea-foster-experience\"\n          className=\"mt-2\"\n        />\n        <p className=\"text-sm text-muted-foreground mt-1\">\n          Any relevant experience will help us match you with appropriate dogs.\n        </p>\n        <FormError error={errors?.experience} />\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;;;;;;;AAEA,SAAS,WAAW,EAAE,KAAK,EAAmC;IAC5D,IAAI,CAAC,SAAS,MAAM,MAAM,KAAK,GAAG,OAAO;IACzC,qBAAO,6LAAC;QAAE,WAAU;kBAA6B,KAAK,CAAC,EAAE;;;;;;AAC3D;KAHS;AAWM,SAAS,sBAAsB,EAAE,MAAM,EAAE,SAAS,EAAE,YAAY,EAA8B;IAC3G,8DAA8D;IAC9D,MAAM,WAAW,CAAC;QAChB,OAAO,AAAC,WAAW,CAAC,IAAI,IAAgB,cAAc,CAAC,IAAI,IAAe;IAC5E;IAEA,MAAM,kBAAkB,CAAC;QACvB,OAAO,AAAC,WAAW,CAAC,IAAI,IAAiB,cAAc,CAAC,IAAI,IAAgB;IAC9E;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAG,WAAU;0BAAwB;;;;;;0BAEtC,6LAAC;;kCACC,6LAAC,sIAAK;wBAAC,SAAQ;kCAAiB;;;;;;kCAChC,6LAAC,sIAAK;wBACJ,IAAG;wBACH,MAAK;wBACL,MAAK;wBACL,KAAI;wBACJ,KAAI;wBACJ,aAAY;wBACZ,cAAc,SAAS;wBACvB,eAAY;wBACZ,WAAU;;;;;;kCAEZ,6LAAC;wBAAE,WAAU;kCAAqC;;;;;;kCAGlD,6LAAC,kJAAS;wBAAC,OAAO,QAAQ;;;;;;;;;;;;0BAG5B,6LAAC;;kCACC,6LAAC,sIAAK;kCAAC;;;;;;kCACP,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC,4IAAQ;wCACP,IAAG;wCACH,MAAK;wCACL,gBAAgB,gBAAgB;wCAChC,eAAY;;;;;;kDAEd,6LAAC,sIAAK;wCAAC,SAAQ;wCAAU,WAAU;kDAAc;;;;;;;;;;;;0CAInD,6LAAC;gCAAI,WAAU;;kDACb,6LAAC,4IAAQ;wCACP,IAAG;wCACH,MAAK;wCACL,gBAAgB,gBAAgB;wCAChC,eAAY;;;;;;kDAEd,6LAAC,sIAAK;wCAAC,SAAQ;wCAAU,WAAU;kDAAc;;;;;;;;;;;;0CAInD,6LAAC;gCAAI,WAAU;;kDACb,6LAAC,4IAAQ;wCACP,IAAG;wCACH,MAAK;wCACL,gBAAgB,gBAAgB;wCAChC,eAAY;;;;;;kDAEd,6LAAC,sIAAK;wCAAC,SAAQ;wCAAoB,WAAU;kDAAc;;;;;;;;;;;;;;;;;;kCAK/D,6LAAC;wBAAW,OAAO,QAAQ,WAAW,QAAQ,WAAW,QAAQ;;;;;;;;;;;;0BAGnE,6LAAC;;kCACC,6LAAC,sIAAK;wBAAC,SAAQ;kCAAa;;;;;;kCAC5B,6LAAC,4IAAQ;wBACP,IAAG;wBACH,MAAK;wBACL,aAAY;wBACZ,cAAc,SAAS;wBACvB,eAAY;wBACZ,WAAU;;;;;;kCAEZ,6LAAC;wBAAE,WAAU;kCAAqC;;;;;;kCAGlD,6LAAC,kJAAS;wBAAC,OAAO,QAAQ;;;;;;;;;;;;;;;;;;AAIlC;MA1FwB","debugId":null}},
    {"offset": {"line": 960, "column": 0}, "map": {"version":3,"sources":["file:///Users/adampeterson/Github/mutts/components/ui/radio-group.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { CircleIcon } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction RadioGroup({\n  className,\n  ...props\n}: React.ComponentProps<typeof RadioGroupPrimitive.Root>) {\n  return (\n    <RadioGroupPrimitive.Root\n      data-slot=\"radio-group\"\n      className={cn(\"grid gap-3\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction RadioGroupItem({\n  className,\n  ...props\n}: React.ComponentProps<typeof RadioGroupPrimitive.Item>) {\n  return (\n    <RadioGroupPrimitive.Item\n      data-slot=\"radio-group-item\"\n      className={cn(\n        \"border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator\n        data-slot=\"radio-group-indicator\"\n        className=\"relative flex items-center justify-center\"\n      >\n        <CircleIcon className=\"fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n}\n\nexport { RadioGroup, RadioGroupItem }\n"],"names":[],"mappings":";;;;;;;AAGA;AACA;AAEA;AANA;;;;;AAQA,SAAS,WAAW,EAClB,SAAS,EACT,GAAG,OACmD;IACtD,qBACE,6LAAC,qLAAwB;QACvB,aAAU;QACV,WAAW,IAAA,qIAAE,EAAC,cAAc;QAC3B,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,eAAe,EACtB,SAAS,EACT,GAAG,OACmD;IACtD,qBACE,6LAAC,qLAAwB;QACvB,aAAU;QACV,WAAW,IAAA,qIAAE,EACX,0XACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,0LAA6B;YAC5B,aAAU;YACV,WAAU;sBAEV,cAAA,6LAAC,2NAAU;gBAAC,WAAU;;;;;;;;;;;;;;;;AAI9B;MArBS","debugId":null}},
    {"offset": {"line": 1025, "column": 0}, "map": {"version":3,"sources":["file:///Users/adampeterson/Github/mutts/app/apply/_components/form-sections/HousingInfoSection.tsx"],"sourcesContent":["import { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { RadioGroup, RadioGroupItem } from \"@/components/ui/radio-group\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\n\nfunction FieldError({ error }: { error: string[] | undefined }) {\n  if (!error || error.length === 0) return null;\n  return <p className=\"text-red-500 text-sm mt-1\">{error[0]}</p>;\n}\n\ninterface HousingInfoSectionProps {\n  errors?: Record<string, string[]> | null;\n  savedData?: Record<string, unknown> | null;\n  previousData?: Record<string, unknown> | null;\n}\n\nexport default function HousingInfoSection({ errors, savedData, previousData }: HousingInfoSectionProps) {\n  // Helper to get value with priority: savedData > previousData\n  const getValue = (key: string) => {\n    return (savedData?.[key] as string) || (previousData?.[key] as string) || undefined;\n  };\n\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <Label htmlFor=\"housingType\">Housing Type</Label>\n        <select\n          id=\"housingType\"\n          name=\"housingType\"\n          className=\"mt-2 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-indigo-500 focus:outline-none focus:ring-indigo-500\"\n          defaultValue={getValue(\"housingType\") || \"\"}\n          data-testid=\"select-housing-type\"\n        >\n          <option value=\"\">Select housing type</option>\n          <option value=\"OWN_HOME\">Own Home</option>\n          <option value=\"RENT_HOME\">Rent Home</option>\n          <option value=\"OWN_APT_CONDO\">Own Apt/Condo</option>\n          <option value=\"RENT_APT_CONDO\">Rent Apt/Condo</option>\n          <option value=\"OTHER\">Other</option>\n        </select>\n        <FieldError error={errors?.housingType} />\n      </div>\n\n      <div>\n        <Label>Do you have a yard?</Label>\n        <RadioGroup name=\"hasYard\" className=\"flex flex-row space-x-6 mt-2\" defaultValue={getValue(\"hasYard\")} data-testid=\"radio-has-yard\">\n          <div className=\"flex items-center space-x-2\">\n            <RadioGroupItem value=\"YES\" id=\"yard-yes\" />\n            <Label htmlFor=\"yard-yes\" className=\"font-normal\">Yes</Label>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <RadioGroupItem value=\"NO\" id=\"yard-no\" />\n            <Label htmlFor=\"yard-no\" className=\"font-normal\">No</Label>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <RadioGroupItem value=\"SHARED\" id=\"yard-shared\" />\n            <Label htmlFor=\"yard-shared\" className=\"font-normal\">Shared</Label>\n          </div>\n        </RadioGroup>\n        <FieldError error={errors?.hasYard} />\n      </div>\n\n      <div>\n        <div className=\"flex items-center space-x-2\">\n          <Checkbox\n            id=\"yardFenced\"\n            name=\"yardFenced\"\n            defaultChecked={getValue(\"yardFenced\") === \"true\"}\n            data-testid=\"radio-yard-fenced\"\n          />\n          <Label htmlFor=\"yardFenced\">Is your yard fenced?</Label>\n        </div>\n        <p className=\"text-sm text-muted-foreground mt-1\">\n          Required for safety if you have a yard.\n        </p>\n        <FieldError error={errors?.yardFenced} />\n      </div>\n\n      <div>\n        <Label htmlFor=\"otherPets\">Other Pets in Household (Optional)</Label>\n        <Textarea\n          id=\"otherPets\"\n          name=\"otherPets\"\n          placeholder=\"List type, breed, age, and temperament of other pets...\"\n          defaultValue={getValue(\"otherPets\") || \"\"}\n        />\n      </div>\n\n      <div>\n        <Label htmlFor=\"homeEnvironmentDescription\">Describe Your Home Environment</Label>\n        <Textarea\n          id=\"homeEnvironmentDescription\"\n          name=\"homeEnvironmentDescription\"\n          placeholder=\"e.g., Quiet apartment, busy house with kids, activity level, who lives there...\"\n          className=\"min-h-[100px]\"\n          defaultValue={getValue(\"homeEnvironmentDescription\") || \"\"}\n        />\n        <p className=\"text-sm text-muted-foreground mt-1\">\n          Help us understand the setting the dog would live in.\n        </p>\n        <FieldError error={errors?.homeEnvironmentDescription} />\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;;;;;;AAEA,SAAS,WAAW,EAAE,KAAK,EAAmC;IAC5D,IAAI,CAAC,SAAS,MAAM,MAAM,KAAK,GAAG,OAAO;IACzC,qBAAO,6LAAC;QAAE,WAAU;kBAA6B,KAAK,CAAC,EAAE;;;;;;AAC3D;KAHS;AAWM,SAAS,mBAAmB,EAAE,MAAM,EAAE,SAAS,EAAE,YAAY,EAA2B;IACrG,8DAA8D;IAC9D,MAAM,WAAW,CAAC;QAChB,OAAO,AAAC,WAAW,CAAC,IAAI,IAAgB,cAAc,CAAC,IAAI,IAAe;IAC5E;IAGA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;;kCACC,6LAAC,sIAAK;wBAAC,SAAQ;kCAAc;;;;;;kCAC7B,6LAAC;wBACC,IAAG;wBACH,MAAK;wBACL,WAAU;wBACV,cAAc,SAAS,kBAAkB;wBACzC,eAAY;;0CAEZ,6LAAC;gCAAO,OAAM;0CAAG;;;;;;0CACjB,6LAAC;gCAAO,OAAM;0CAAW;;;;;;0CACzB,6LAAC;gCAAO,OAAM;0CAAY;;;;;;0CAC1B,6LAAC;gCAAO,OAAM;0CAAgB;;;;;;0CAC9B,6LAAC;gCAAO,OAAM;0CAAiB;;;;;;0CAC/B,6LAAC;gCAAO,OAAM;0CAAQ;;;;;;;;;;;;kCAExB,6LAAC;wBAAW,OAAO,QAAQ;;;;;;;;;;;;0BAG7B,6LAAC;;kCACC,6LAAC,sIAAK;kCAAC;;;;;;kCACP,6LAAC,oJAAU;wBAAC,MAAK;wBAAU,WAAU;wBAA+B,cAAc,SAAS;wBAAY,eAAY;;0CACjH,6LAAC;gCAAI,WAAU;;kDACb,6LAAC,wJAAc;wCAAC,OAAM;wCAAM,IAAG;;;;;;kDAC/B,6LAAC,sIAAK;wCAAC,SAAQ;wCAAW,WAAU;kDAAc;;;;;;;;;;;;0CAEpD,6LAAC;gCAAI,WAAU;;kDACb,6LAAC,wJAAc;wCAAC,OAAM;wCAAK,IAAG;;;;;;kDAC9B,6LAAC,sIAAK;wCAAC,SAAQ;wCAAU,WAAU;kDAAc;;;;;;;;;;;;0CAEnD,6LAAC;gCAAI,WAAU;;kDACb,6LAAC,wJAAc;wCAAC,OAAM;wCAAS,IAAG;;;;;;kDAClC,6LAAC,sIAAK;wCAAC,SAAQ;wCAAc,WAAU;kDAAc;;;;;;;;;;;;;;;;;;kCAGzD,6LAAC;wBAAW,OAAO,QAAQ;;;;;;;;;;;;0BAG7B,6LAAC;;kCACC,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,4IAAQ;gCACP,IAAG;gCACH,MAAK;gCACL,gBAAgB,SAAS,kBAAkB;gCAC3C,eAAY;;;;;;0CAEd,6LAAC,sIAAK;gCAAC,SAAQ;0CAAa;;;;;;;;;;;;kCAE9B,6LAAC;wBAAE,WAAU;kCAAqC;;;;;;kCAGlD,6LAAC;wBAAW,OAAO,QAAQ;;;;;;;;;;;;0BAG7B,6LAAC;;kCACC,6LAAC,sIAAK;wBAAC,SAAQ;kCAAY;;;;;;kCAC3B,6LAAC,4IAAQ;wBACP,IAAG;wBACH,MAAK;wBACL,aAAY;wBACZ,cAAc,SAAS,gBAAgB;;;;;;;;;;;;0BAI3C,6LAAC;;kCACC,6LAAC,sIAAK;wBAAC,SAAQ;kCAA6B;;;;;;kCAC5C,6LAAC,4IAAQ;wBACP,IAAG;wBACH,MAAK;wBACL,aAAY;wBACZ,WAAU;wBACV,cAAc,SAAS,iCAAiC;;;;;;kCAE1D,6LAAC;wBAAE,WAAU;kCAAqC;;;;;;kCAGlD,6LAAC;wBAAW,OAAO,QAAQ;;;;;;;;;;;;;;;;;;AAInC;MAzFwB","debugId":null}},
    {"offset": {"line": 1391, "column": 0}, "map": {"version":3,"sources":["file:///Users/adampeterson/Github/mutts/app/apply/_components/form-sections/ReasonSection.tsx"],"sourcesContent":["import { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { AppType } from \"@prisma/client\";\n\nfunction FieldError({ error }: { error: string[] | undefined }) {\n  if (!error || error.length === 0) return null;\n  return <p className=\"text-red-500 text-sm mt-1\">{error[0]}</p>;\n}\n\ninterface ReasonSectionProps {\n  formType: AppType;\n  errors?: Record<string, string[]> | null;\n  savedData?: Record<string, unknown> | null;\n  previousData?: Record<string, unknown> | null;\n}\n\nexport default function ReasonSection({ formType, errors, savedData, previousData }: ReasonSectionProps) {\n  // Helper to get value with priority: savedData > previousData\n  const getValue = (key: string) => {\n    return (savedData?.[key] as string) || (previousData?.[key] as string) || \"\";\n  };\n\n  return (\n    <div>\n      <Label htmlFor=\"reason\">Why {formType === AppType.ADOPTER ? 'Adopt' : 'Foster'} a Senior Dog?</Label>\n      <Textarea\n        id=\"reason\"\n        name=\"reason\"\n        placeholder={`Tell us a little about why you're interested in ${formType === AppType.ADOPTER ? 'adopting' : 'fostering'} a senior dog...`}\n        className=\"min-h-[100px] mt-2\"\n        defaultValue={getValue(\"reason\")}\n        data-testid=\"textarea-reason\"\n      />\n      <p className=\"text-sm text-muted-foreground mt-1\">\n        Share your motivation and what kind of home you can offer.\n      </p>\n      <FieldError error={errors?.reason} />\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;;AAEA,SAAS,WAAW,EAAE,KAAK,EAAmC;IAC5D,IAAI,CAAC,SAAS,MAAM,MAAM,KAAK,GAAG,OAAO;IACzC,qBAAO,6LAAC;QAAE,WAAU;kBAA6B,KAAK,CAAC,EAAE;;;;;;AAC3D;KAHS;AAYM,SAAS,cAAc,EAAE,QAAQ,EAAE,MAAM,EAAE,SAAS,EAAE,YAAY,EAAsB;IACrG,8DAA8D;IAC9D,MAAM,WAAW,CAAC;QAChB,OAAO,AAAC,WAAW,CAAC,IAAI,IAAgB,cAAc,CAAC,IAAI,IAAe;IAC5E;IAEA,qBACE,6LAAC;;0BACC,6LAAC,sIAAK;gBAAC,SAAQ;;oBAAS;oBAAK,aAAa,oKAAO,CAAC,OAAO,GAAG,UAAU;oBAAS;;;;;;;0BAC/E,6LAAC,4IAAQ;gBACP,IAAG;gBACH,MAAK;gBACL,aAAa,CAAC,gDAAgD,EAAE,aAAa,oKAAO,CAAC,OAAO,GAAG,aAAa,YAAY,gBAAgB,CAAC;gBACzI,WAAU;gBACV,cAAc,SAAS;gBACvB,eAAY;;;;;;0BAEd,6LAAC;gBAAE,WAAU;0BAAqC;;;;;;0BAGlD,6LAAC;gBAAW,OAAO,QAAQ;;;;;;;;;;;;AAGjC;MAvBwB","debugId":null}},
    {"offset": {"line": 1479, "column": 0}, "map": {"version":3,"sources":["file:///Users/adampeterson/Github/mutts/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost:\n          \"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-9 px-4 py-2 has-[>svg]:px-3\",\n        sm: \"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5\",\n        lg: \"h-10 rounded-md px-6 has-[>svg]:px-4\",\n        icon: \"size-9\",\n        \"icon-sm\": \"size-8\",\n        \"icon-lg\": \"size-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction Button({\n  className,\n  variant,\n  size,\n  asChild = false,\n  type = \"button\",\n  ...props\n}: React.ComponentProps<\"button\"> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      className={cn(buttonVariants({ variant, size, className }))}\n      type={Comp === \"button\" ? type : undefined}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,0KAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,OAAO,QAAQ,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,2KAAI,GAAG;IAE9B,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qIAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACxD,MAAM,SAAS,WAAW,OAAO;QAChC,GAAG,KAAK;;;;;;AAGf;KArBS","debugId":null}},
    {"offset": {"line": 1545, "column": 0}, "map": {"version":3,"sources":["file:///Users/adampeterson/Github/mutts/app/apply/_components/form-sections/ReferencesSection.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { Label } from \"@/components/ui/label\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { FormError } from \"@/components/ui/form-error\";\nimport { Plus, Trash2 } from \"lucide-react\";\n\n\ninterface Reference {\n  name: string;\n  phone: string;\n  relationship: string;\n}\n\ninterface ReferencesSectionProps {\n  errors?: Record<string, string[]> | null;\n  savedData?: Record<string, unknown> | null;\n  previousData?: Record<string, unknown> | null;\n}\n\nexport default function ReferencesSection({ errors, savedData, previousData }: ReferencesSectionProps) {\n  // Initialize references with priority: savedData > previousData > empty\n  const getInitialReferences = () => {\n    // First try savedData\n    if (savedData?.references && Array.isArray(savedData.references) && savedData.references.length > 0) {\n      return savedData.references.map((ref: unknown) => {\n        const reference = ref as { name?: string; phone?: string; relationship?: string };\n        return {\n          name: reference.name || \"\",\n          phone: reference.phone || \"\",\n          relationship: reference.relationship || \"\",\n        };\n      });\n    }\n\n    // Then try previousData\n    if (previousData?.references && Array.isArray(previousData.references) && previousData.references.length > 0) {\n      return previousData.references.map((ref: unknown) => {\n        const reference = ref as { name?: string; phone?: string; relationship?: string };\n        return {\n          name: reference.name || \"\",\n          phone: reference.phone || \"\",\n          relationship: reference.relationship || \"\",\n        };\n      });\n    }\n\n    // Default to empty reference\n    return [{ name: \"\", phone: \"\", relationship: \"\" }];\n  };\n\n  const initialReferences = getInitialReferences();\n\n  const [references, setReferences] = useState<Reference[]>(initialReferences);\n\n  const addReference = () => {\n    setReferences([...references, { name: \"\", phone: \"\", relationship: \"\" }]);\n  };\n\n  const removeReference = (index: number) => {\n    if (references.length > 1) {\n      setReferences(references.filter((_, i) => i !== index));\n    }\n  };\n\n  const updateReference = (index: number, field: keyof Reference, value: string) => {\n    const updatedReferences = references.map((ref, i) =>\n      i === index ? { ...ref, [field]: value } : ref\n    );\n    setReferences(updatedReferences);\n  };\n\n  return (\n    <div className=\"space-y-4 p-4 border rounded-md\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h3 className=\"text-lg font-medium\">References (Optional)</h3>\n          <p className=\"text-sm text-muted-foreground\">Please provide personal references (non-family members).</p>\n        </div>\n        <Button type=\"button\" variant=\"outline\" size=\"sm\" onClick={addReference}>\n          <Plus className=\"h-4 w-4 mr-2\" />\n          Add Reference\n        </Button>\n      </div>\n\n      <div className=\"space-y-4\">\n        {references.map((reference, index) => (\n          <div key={index} className=\"relative p-4 border rounded-md bg-muted/20\">\n            <div className=\"flex justify-between items-start mb-3\">\n              <h4 className=\"font-medium\">Reference {index + 1}</h4>\n              {references.length > 1 && (\n                <Button\n                  type=\"button\"\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={() => removeReference(index)}\n                  className=\"text-destructive hover:text-destructive\"\n                >\n                  <Trash2 className=\"h-4 w-4\" />\n                </Button>\n              )}\n            </div>\n\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              <div>\n                <Label htmlFor={`referenceName-${index}`}>Name</Label>\n                <Input\n                  id={`referenceName-${index}`}\n                  name={`references[${index}][name]`}\n                  value={reference.name}\n                  onChange={(e) => updateReference(index, 'name', e.target.value)}\n                  placeholder=\"Name\"\n                  required\n                  data-testid={`input-reference-${index + 1}-name`}\n                />\n                <FormError error={errors?.[`references.${index}.name`]} />\n              </div>\n              <div>\n                <Label htmlFor={`referencePhone-${index}`}>Phone</Label>\n                <Input\n                  id={`referencePhone-${index}`}\n                  name={`references[${index}][phone]`}\n                  type=\"tel\"\n                  value={reference.phone}\n                  onChange={(e) => updateReference(index, 'phone', e.target.value)}\n                  placeholder=\"Phone\"\n                  data-testid={`input-reference-${index + 1}-phone`}\n                />\n                <FormError error={errors?.[`references.${index}.phone`]} />\n              </div>\n              <div>\n                <Label htmlFor={`referenceRelationship-${index}`}>Relationship</Label>\n                <Input\n                  id={`referenceRelationship-${index}`}\n                  name={`references[${index}][relationship]`}\n                  value={reference.relationship}\n                  onChange={(e) => updateReference(index, 'relationship', e.target.value)}\n                  placeholder=\"e.g., Friend\"\n                />\n                <FormError error={errors?.[`references.${index}.relationship`]} />\n              </div>\n            </div>\n          </div>\n        ))}\n      </div>\n\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;;;AAPA;;;;;;;AAsBe,SAAS,kBAAkB,EAAE,MAAM,EAAE,SAAS,EAAE,YAAY,EAA0B;;IACnG,wEAAwE;IACxE,MAAM,uBAAuB;QAC3B,sBAAsB;QACtB,IAAI,WAAW,cAAc,MAAM,OAAO,CAAC,UAAU,UAAU,KAAK,UAAU,UAAU,CAAC,MAAM,GAAG,GAAG;YACnG,OAAO,UAAU,UAAU,CAAC,GAAG,CAAC,CAAC;gBAC/B,MAAM,YAAY;gBAClB,OAAO;oBACL,MAAM,UAAU,IAAI,IAAI;oBACxB,OAAO,UAAU,KAAK,IAAI;oBAC1B,cAAc,UAAU,YAAY,IAAI;gBAC1C;YACF;QACF;QAEA,wBAAwB;QACxB,IAAI,cAAc,cAAc,MAAM,OAAO,CAAC,aAAa,UAAU,KAAK,aAAa,UAAU,CAAC,MAAM,GAAG,GAAG;YAC5G,OAAO,aAAa,UAAU,CAAC,GAAG,CAAC,CAAC;gBAClC,MAAM,YAAY;gBAClB,OAAO;oBACL,MAAM,UAAU,IAAI,IAAI;oBACxB,OAAO,UAAU,KAAK,IAAI;oBAC1B,cAAc,UAAU,YAAY,IAAI;gBAC1C;YACF;QACF;QAEA,6BAA6B;QAC7B,OAAO;YAAC;gBAAE,MAAM;gBAAI,OAAO;gBAAI,cAAc;YAAG;SAAE;IACpD;IAEA,MAAM,oBAAoB;IAE1B,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAc;IAE1D,MAAM,eAAe;QACnB,cAAc;eAAI;YAAY;gBAAE,MAAM;gBAAI,OAAO;gBAAI,cAAc;YAAG;SAAE;IAC1E;IAEA,MAAM,kBAAkB,CAAC;QACvB,IAAI,WAAW,MAAM,GAAG,GAAG;YACzB,cAAc,WAAW,MAAM,CAAC,CAAC,GAAG,IAAM,MAAM;QAClD;IACF;IAEA,MAAM,kBAAkB,CAAC,OAAe,OAAwB;QAC9D,MAAM,oBAAoB,WAAW,GAAG,CAAC,CAAC,KAAK,IAC7C,MAAM,QAAQ;gBAAE,GAAG,GAAG;gBAAE,CAAC,MAAM,EAAE;YAAM,IAAI;QAE7C,cAAc;IAChB;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;;0CACC,6LAAC;gCAAG,WAAU;0CAAsB;;;;;;0CACpC,6LAAC;gCAAE,WAAU;0CAAgC;;;;;;;;;;;;kCAE/C,6LAAC,wIAAM;wBAAC,MAAK;wBAAS,SAAQ;wBAAU,MAAK;wBAAK,SAAS;;0CACzD,6LAAC,6MAAI;gCAAC,WAAU;;;;;;4BAAiB;;;;;;;;;;;;;0BAKrC,6LAAC;gBAAI,WAAU;0BACZ,WAAW,GAAG,CAAC,CAAC,WAAW,sBAC1B,6LAAC;wBAAgB,WAAU;;0CACzB,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAG,WAAU;;4CAAc;4CAAW,QAAQ;;;;;;;oCAC9C,WAAW,MAAM,GAAG,mBACnB,6LAAC,wIAAM;wCACL,MAAK;wCACL,SAAQ;wCACR,MAAK;wCACL,SAAS,IAAM,gBAAgB;wCAC/B,WAAU;kDAEV,cAAA,6LAAC,uNAAM;4CAAC,WAAU;;;;;;;;;;;;;;;;;0CAKxB,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;;0DACC,6LAAC,sIAAK;gDAAC,SAAS,CAAC,cAAc,EAAE,OAAO;0DAAE;;;;;;0DAC1C,6LAAC,sIAAK;gDACJ,IAAI,CAAC,cAAc,EAAE,OAAO;gDAC5B,MAAM,CAAC,WAAW,EAAE,MAAM,OAAO,CAAC;gDAClC,OAAO,UAAU,IAAI;gDACrB,UAAU,CAAC,IAAM,gBAAgB,OAAO,QAAQ,EAAE,MAAM,CAAC,KAAK;gDAC9D,aAAY;gDACZ,QAAQ;gDACR,eAAa,CAAC,gBAAgB,EAAE,QAAQ,EAAE,KAAK,CAAC;;;;;;0DAElD,6LAAC,kJAAS;gDAAC,OAAO,QAAQ,CAAC,CAAC,WAAW,EAAE,MAAM,KAAK,CAAC,CAAC;;;;;;;;;;;;kDAExD,6LAAC;;0DACC,6LAAC,sIAAK;gDAAC,SAAS,CAAC,eAAe,EAAE,OAAO;0DAAE;;;;;;0DAC3C,6LAAC,sIAAK;gDACJ,IAAI,CAAC,eAAe,EAAE,OAAO;gDAC7B,MAAM,CAAC,WAAW,EAAE,MAAM,QAAQ,CAAC;gDACnC,MAAK;gDACL,OAAO,UAAU,KAAK;gDACtB,UAAU,CAAC,IAAM,gBAAgB,OAAO,SAAS,EAAE,MAAM,CAAC,KAAK;gDAC/D,aAAY;gDACZ,eAAa,CAAC,gBAAgB,EAAE,QAAQ,EAAE,MAAM,CAAC;;;;;;0DAEnD,6LAAC,kJAAS;gDAAC,OAAO,QAAQ,CAAC,CAAC,WAAW,EAAE,MAAM,MAAM,CAAC,CAAC;;;;;;;;;;;;kDAEzD,6LAAC;;0DACC,6LAAC,sIAAK;gDAAC,SAAS,CAAC,sBAAsB,EAAE,OAAO;0DAAE;;;;;;0DAClD,6LAAC,sIAAK;gDACJ,IAAI,CAAC,sBAAsB,EAAE,OAAO;gDACpC,MAAM,CAAC,WAAW,EAAE,MAAM,eAAe,CAAC;gDAC1C,OAAO,UAAU,YAAY;gDAC7B,UAAU,CAAC,IAAM,gBAAgB,OAAO,gBAAgB,EAAE,MAAM,CAAC,KAAK;gDACtE,aAAY;;;;;;0DAEd,6LAAC,kJAAS;gDAAC,OAAO,QAAQ,CAAC,CAAC,WAAW,EAAE,MAAM,aAAa,CAAC,CAAC;;;;;;;;;;;;;;;;;;;uBApD1D;;;;;;;;;;;;;;;;AA6DpB;GAhIwB;KAAA","debugId":null}},
    {"offset": {"line": 1868, "column": 0}, "map": {"version":3,"sources":["file:///Users/adampeterson/Github/mutts/app/apply/_components/ApplicationForm.tsx"],"sourcesContent":["// components/apply/ApplicationForm.tsx\n\"use client\";\n\nimport { useActionState } from \"react\";\nimport { useFormStatus } from \"react-dom\";\nimport { AppType } from \"@prisma/client\";\nimport { createApplication } from \"@/lib/actions/application.actions\";\nimport { makeActionResult } from \"@/lib/types\";\n\nimport ContactInfoSection from \"./form-sections/ContactInfoSection\";\nimport FosterSpecificSection from \"./form-sections/FosterSpecificSection\";\nimport HousingInfoSection from \"./form-sections/HousingInfoSection\";\nimport ReasonSection from \"./form-sections/ReasonSection\";\nimport ReferencesSection from \"./form-sections/ReferencesSection\";\n\ninterface ApplicationFormProps {\n  formType: AppType;\n  dogId?: number;\n}\n\n\n// This is a real submit button\nfunction SubmitButton() {\n  const { pending } = useFormStatus();\n  return (\n    <button\n      type=\"submit\" // <-- This is a REAL submit button\n      disabled={pending}\n      className=\"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n      data-testid=\"btn-submit-application\"\n    >\n      {pending ? 'Submitting...' : 'Submit Application'}\n    </button>\n  );\n}\n\nexport default function ApplicationForm({ formType, dogId }: ApplicationFormProps) {\n  // Use the server action\n  const [state, formAction] = useActionState(createApplication, makeActionResult());\n\n  return (\n    <div className=\"flex-1 w-full flex flex-col items-center p-8\">\n      <div className=\"w-full max-w-2xl\">\n        <h1 className=\"text-3xl font-bold mb-6 text-center\">\n          {formType === AppType.ADOPTER ? 'Adoption' : 'Foster'} Application\n        </h1>\n\n        {/* This is now a real form */}\n        <form\n          action={formAction} // <-- Pass the action\n          className=\"space-y-8\"\n          data-testid={formType === AppType.ADOPTER ? \"adopt-form\" : \"foster-form\"}\n        >\n          <input type=\"hidden\" name=\"formType\" value={formType} />\n          {dogId && <input type=\"hidden\" name=\"dogId\" value={dogId.toString()} />}\n\n          {/* Pass the server errors down to the sections */}\n          <ContactInfoSection errors={state.fieldErrors} savedData={null} previousData={null} userProfile={null} />\n          <HousingInfoSection errors={state.fieldErrors} savedData={null} previousData={null} />\n          {formType === AppType.FOSTER && (\n            <FosterSpecificSection errors={state.fieldErrors} savedData={null} previousData={null} />\n          )}\n          <ReasonSection formType={formType} errors={state.fieldErrors} savedData={null} previousData={null} />\n          <ReferencesSection errors={state.fieldErrors} savedData={null} previousData={null} />\n\n          {/* Show global error message */}\n          {state.message && !state.success && (\n            <div className=\"text-red-500\" role=\"alert\">\n              {state.message}\n            </div>\n          )}\n\n          <div className=\"flex flex-col gap-4\">\n            <SubmitButton />\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"AAAA,uCAAuC;;;;;;AAGvC;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;;;AAZA;;;;;;;;;;;AAoBA,+BAA+B;AAC/B,SAAS;;IACP,MAAM,EAAE,OAAO,EAAE,GAAG,IAAA,qLAAa;IACjC,qBACE,6LAAC;QACC,MAAK;QACL,UAAU;QACV,WAAU;QACV,eAAY;kBAEX,UAAU,kBAAkB;;;;;;AAGnC;GAZS;;QACa,qLAAa;;;KAD1B;AAcM,SAAS,gBAAgB,EAAE,QAAQ,EAAE,KAAK,EAAwB;;IAC/E,wBAAwB;IACxB,MAAM,CAAC,OAAO,WAAW,GAAG,IAAA,+KAAc,EAAC,8KAAiB,EAAE,IAAA,mIAAgB;IAE9E,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAG,WAAU;;wBACX,aAAa,oKAAO,CAAC,OAAO,GAAG,aAAa;wBAAS;;;;;;;8BAIxD,6LAAC;oBACC,QAAQ;oBACR,WAAU;oBACV,eAAa,aAAa,oKAAO,CAAC,OAAO,GAAG,eAAe;;sCAE3D,6LAAC;4BAAM,MAAK;4BAAS,MAAK;4BAAW,OAAO;;;;;;wBAC3C,uBAAS,6LAAC;4BAAM,MAAK;4BAAS,MAAK;4BAAQ,OAAO,MAAM,QAAQ;;;;;;sCAGjE,6LAAC,oLAAkB;4BAAC,QAAQ,MAAM,WAAW;4BAAE,WAAW;4BAAM,cAAc;4BAAM,aAAa;;;;;;sCACjG,6LAAC,oLAAkB;4BAAC,QAAQ,MAAM,WAAW;4BAAE,WAAW;4BAAM,cAAc;;;;;;wBAC7E,aAAa,oKAAO,CAAC,MAAM,kBAC1B,6LAAC,uLAAqB;4BAAC,QAAQ,MAAM,WAAW;4BAAE,WAAW;4BAAM,cAAc;;;;;;sCAEnF,6LAAC,+KAAa;4BAAC,UAAU;4BAAU,QAAQ,MAAM,WAAW;4BAAE,WAAW;4BAAM,cAAc;;;;;;sCAC7F,6LAAC,mLAAiB;4BAAC,QAAQ,MAAM,WAAW;4BAAE,WAAW;4BAAM,cAAc;;;;;;wBAG5E,MAAM,OAAO,IAAI,CAAC,MAAM,OAAO,kBAC9B,6LAAC;4BAAI,WAAU;4BAAe,MAAK;sCAChC,MAAM,OAAO;;;;;;sCAIlB,6LAAC;4BAAI,WAAU;sCACb,cAAA,6LAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMb;IA3CwB;;QAEM,+KAAc;;;MAFpB","debugId":null}}]
}